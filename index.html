<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ø®Ø§Ø±Ù‚ | Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØ§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠ</title>
    
    <!-- Ø®Ø·ÙˆØ· Ø¹Ø±Ø¨ÙŠØ© -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- TensorFlow.js Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…Ø­Ù„ÙŠ -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/universal-sentence-encoder@1.3.3/dist/universal-sentence-encoder.min.js"></script>
    
    <!-- Tesseract.js Ù„Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù†ØµÙˆØµ Ù…Ù† Ø§Ù„ØµÙˆØ± -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    
    <style>
        :root {
            --bg-dark: #0a0a1a;
            --bg-darker: #050510;
            --bg-card: #151530;
            --primary: #00f5ff;
            --primary-dark: #00b4d8;
            --accent: #ff006e;
            --accent-light: #ff4da6;
            --neon-blue: #00f5ff;
            --neon-purple: #9d4edd;
            --neon-green: #00ff9d;
            --neon-yellow: #ffd166;
            --text-main: #ffffff;
            --text-secondary: #b8b8d1;
            --text-dim: #8a8aa3;
            --gradient-ai: linear-gradient(135deg, #00f5ff 0%, #9d4edd 50%, #ff006e 100%);
            --gradient-dark: linear-gradient(180deg, #0a0a1a 0%, #050510 100%);
            --gradient-card: linear-gradient(145deg, #151530 0%, #101025 100%);
            --shadow-glow: 0 0 30px rgba(0, 245, 255, 0.3);
            --shadow-heavy: 0 10px 40px rgba(0, 0, 0, 0.5);
            --shadow-accent: 0 0 25px rgba(255, 0, 110, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
        }

        body {
            background: var(--gradient-dark);
            color: var(--text-main);
            min-height: 100vh;
            direction: rtl;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 245, 255, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(157, 78, 221, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 0, 110, 0.05) 0%, transparent 50%);
            z-index: -1;
        }

        .hidden {
            display: none !important;
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-content {
            text-align: center;
        }

        .ai-loader {
            width: 80px;
            height: 80px;
            border: 4px solid transparent;
            border-top: 4px solid var(--neon-blue);
            border-right: 4px solid var(--neon-purple);
            border-bottom: 4px solid var(--accent);
            border-left: 4px solid var(--neon-green);
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            margin: 0 auto 30px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: var(--neon-blue);
            font-size: 24px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 3px;
            animation: textPulse 2s infinite;
        }

        @keyframes textPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #login-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        .login-container {
            width: 100%;
            max-width: 500px;
            background: var(--gradient-card);
            border-radius: 30px;
            padding: 50px 40px;
            border: 3px solid rgba(0, 245, 255, 0.15);
            box-shadow: var(--shadow-glow), var(--shadow-heavy);
            position: relative;
            z-index: 1;
            backdrop-filter: blur(10px);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0.5deg); }
            50% { transform: translateY(-20px) rotate(-0.5deg); }
        }

        /* Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        #app-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        header {
            background: rgba(10, 10, 25, 0.95);
            backdrop-filter: blur(20px);
            padding: 20px 30px;
            border-bottom: 2px solid rgba(0, 245, 255, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ */
        .sidebar {
            width: 280px;
            background: var(--gradient-card);
            border-left: 2px solid rgba(0, 245, 255, 0.15);
            padding: 20px;
            overflow-y: auto;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 0;
        }

        /* ÙˆØ­Ø¯Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© */
        .module {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            overflow-y: auto;
        }

        .module.active {
            display: block;
        }

        .module-content {
            background: var(--gradient-card);
            border-radius: 25px;
            padding: 30px;
            margin: 50px auto;
            width: 90%;
            max-width: 800px;
            border: 3px solid rgba(0, 245, 255, 0.2);
            box-shadow: var(--shadow-glow);
        }

        /* Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */
        .form-group {
            margin-bottom: 20px;
        }

        .form-control {
            width: 100%;
            padding: 15px;
            background: rgba(10, 10, 25, 0.7);
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--neon-blue);
            box-shadow: 0 0 15px rgba(0, 245, 255, 0.4);
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--gradient-ai);
            color: white;
        }

        .btn-secondary {
            background: rgba(0, 245, 255, 0.1);
            color: var(--neon-blue);
            border: 2px solid var(--neon-blue);
        }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª */
        .quiz-card {
            background: var(--gradient-card);
            border-radius: 20px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid rgba(0, 245, 255, 0.2);
            transition: transform 0.3s;
        }

        .quiz-card:hover {
            transform: translateY(-5px);
            border-color: var(--neon-blue);
        }

        /* Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± */
        .quiz-modal {
            background: var(--gradient-card);
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            margin: 50px auto;
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -2;
        }

        .particle {
            position: absolute;
            background: var(--neon-blue);
            border-radius: 50%;
            animation: floatParticle 15s infinite linear;
        }

        @keyframes floatParticle {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-area {
            margin: 20px 0;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-ai);
            border-radius: 6px;
            transition: width 0.5s ease;
        }

        /* Ø´Ø¬Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª */
        .skill-tree {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }

        .skill-node {
            background: rgba(0, 245, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            border: 2px solid rgba(0, 245, 255, 0.3);
            position: relative;
        }

        .skill-node.unlocked {
            border-color: var(--neon-green);
            background: rgba(0, 255, 157, 0.1);
        }

        .skill-node.locked {
            opacity: 0.5;
            filter: grayscale(0.5);
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© */
        .simulation-area {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            min-height: 300px;
            border: 2px dashed rgba(0, 245, 255, 0.2);
        }

        /* Ø±ØªØ¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
        .user-rank {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(157, 78, 221, 0.1);
            padding: 10px 20px;
            border-radius: 25px;
            border: 2px solid rgba(157, 78, 221, 0.3);
        }

        /* Ø£Ù‚Ø³Ø§Ù… Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .dashboard-section {
            background: var(--gradient-card);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px solid rgba(0, 245, 255, 0.15);
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø±ÙƒØ© */
        .action-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .action-btn {
            background: rgba(0, 245, 255, 0.1);
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-btn:hover {
            background: rgba(0, 245, 255, 0.2);
            border-color: var(--neon-blue);
            transform: translateY(-3px);
        }

        /* Ù…Ø­Ø±Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª */
        .test-editor {
            background: rgba(10, 10, 25, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid rgba(0, 245, 255, 0.2);
        }

        /* ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            
            .module-content {
                width: 95%;
                padding: 20px;
                margin: 20px auto;
            }
            
            .action-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
        @media (min-width: 1200px) {
            .main-content {
                display: flex;
                gap: 20px;
                max-width: 1400px;
                margin: 0 auto;
            }
            
            .sidebar {
                display: block;
            }
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ù…ØªÙˆÙ‡Ø¬Ø© */
        .glow-text {
            text-shadow: 0 0 10px currentColor;
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px currentColor; }
            to { text-shadow: 0 0 20px currentColor; }
        }

        /* Ø±Ø³ÙˆÙ… Ø¨ÙŠØ§Ù†ÙŠØ© */
        .chart-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
        }

        /* Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--gradient-card);
            border-radius: 15px;
            padding: 15px 25px;
            border-left: 5px solid var(--neon-blue);
            box-shadow: var(--shadow-heavy);
            z-index: 3000;
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØªØ¨ÙˆÙŠØ¨ */
        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 12px 24px;
            background: rgba(0, 245, 255, 0.1);
            border: none;
            border-radius: 10px;
            color: var(--text-secondary);
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: var(--gradient-ai);
            color: white;
        }

        /* Ù…Ø­Ø±Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© */
        .code-editor {
            font-family: 'Courier New', monospace;
            background: #1e1e2e;
            color: #cdd6f4;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            direction: ltr;
        }

        /* Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ */
        .ai-simulation {
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            background: linear-gradient(45deg, rgba(0,245,255,0.05), rgba(157,78,221,0.05));
        }

        /* Ø£Ø²Ø±Ø§Ø± Ù…Ø®ØµØµØ© */
        .btn-neon {
            background: transparent;
            border: 2px solid var(--neon-blue);
            color: var(--neon-blue);
            position: relative;
            overflow: hidden;
        }

        .btn-neon::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,245,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn-neon:hover::before {
            left: 100%;
        }

        /* Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù†Øµ */
        .text-area {
            min-height: 150px;
            max-height: 400px;
            resize: vertical;
        }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² */
        .achievement-card {
            background: linear-gradient(135deg, rgba(255,215,102,0.1), rgba(255,215,102,0.05));
            border: 2px solid rgba(255,215,102,0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 10px;
            text-align: center;
            transition: transform 0.3s;
        }

        .achievement-card:hover {
            transform: scale(1.05);
        }

        /* ØªÙ‚Ø¯Ù… Ø¯Ø§Ø¦Ø±ÙŠ */
        .circular-progress {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto;
        }

        .circular-progress svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .circular-progress circle {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
        }

        .circular-progress-bg {
            stroke: rgba(255,255,255,0.1);
        }

        .circular-progress-fill {
            stroke: var(--neon-blue);
            stroke-dasharray: 282.6;
            stroke-dashoffset: 282.6;
            transition: stroke-dashoffset 1s ease;
        }
    </style>
</head>
<body>
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="ai-loader"></div>
            <div class="loading-text">Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø®Ø§Ø±Ù‚</div>
            <div class="progress-bar" style="width: 300px; margin: 20px auto;">
                <div class="progress-fill" id="loading-progress"></div>
            </div>
        </div>
    </div>

    <!-- Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="login-screen" class="hidden">
        <div class="login-container">
            <div style="text-align: center; margin-bottom: 40px;">
                <i class="fas fa-brain-circuit" style="font-size: 80px; background: var(--gradient-ai); -webkit-background-clip: text; -webkit-text-fill-color: transparent;"></i>
                <h1 style="font-size: 42px; background: var(--gradient-ai); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 20px 0;">Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø®Ø§Ø±Ù‚</h1>
                <p style="color: var(--text-secondary);">Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…ØªØ·ÙˆØ± - Ø§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠ</p>
            </div>
            
            <div class="form-group">
                <input type="email" id="login-email" class="form-control" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
            </div>
            
            <div class="form-group">
                <input type="password" id="login-password" class="form-control" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            </div>
            
            <button class="btn btn-primary" onclick="login()" style="width: 100%; margin: 20px 0;">
                <i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            </button>
            
            <button class="btn btn-secondary" onclick="showRegister()" style="width: 100%;">
                <i class="fas fa-user-plus"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
            </button>
        </div>
    </div>

    <!-- Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div id="app-screen" class="hidden">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <header>
            <div class="header-content">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="width: 50px; height: 50px; background: var(--gradient-ai); border-radius: 15px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-brain" style="color: white; font-size: 24px;"></i>
                    </div>
                    <div>
                        <h2 style="background: var(--gradient-ai); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø®Ø§Ø±Ù‚</h2>
                        <p style="color: var(--text-secondary); font-size: 12px;">Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠ</p>
                    </div>
                </div>
                
                <div style="display: flex; align-items: center; gap: 20px;">
                    <div style="text-align: right;">
                        <div id="user-name" style="font-weight: bold; color: var(--neon-blue);"></div>
                        <div id="user-level" style="color: var(--text-secondary); font-size: 12px;"></div>
                    </div>
                    <div style="width: 50px; height: 50px; background: var(--gradient-ai); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white;">
                        <i class="fas fa-user"></i>
                    </div>
                    <button class="btn btn-secondary" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div class="main-content">
            <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
            <div class="sidebar" id="sidebar">
                <h3 style="color: var(--neon-blue); margin-bottom: 20px;"><i class="fas fa-th-large"></i> Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h3>
                
                <div class="action-btn" onclick="openModule('dashboard')">
                    <i class="fas fa-home"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                </div>
                
                <div class="action-btn" onclick="openModule('test-generator')">
                    <i class="fas fa-file-alt"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø±
                </div>
                
                <div class="action-btn" onclick="openModule('test-history')">
                    <i class="fas fa-history"></i> Ø³Ø¬Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
                </div>
                
                <div class="action-btn" onclick="openModule('skill-tree')">
                    <i class="fas fa-project-diagram"></i> Ø´Ø¬Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª
                </div>
                
                <div class="action-btn" onclick="openModule('achievements')">
                    <i class="fas fa-trophy"></i> Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
                </div>
                
                <div class="action-btn" onclick="openModule('simulation')">
                    <i class="fas fa-cogs"></i> Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø°ÙƒØ§Ø¡
                </div>
                
                <div class="action-btn" onclick="openModule('progress')">
                    <i class="fas fa-chart-line"></i> Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ
                </div>
                
                <div class="action-btn" onclick="openModule('ai-training')">
                    <i class="fas fa-robot"></i> ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø°ÙƒØ§Ø¡
                </div>
                
                <div style="margin-top: 40px;">
                    <h3 style="color: var(--neon-blue); margin-bottom: 15px;"><i class="fas fa-brain"></i> Ø­Ø§Ù„Ø© Ø§Ù„Ø°ÙƒØ§Ø¡</h3>
                    <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px;">
                        <div style="margin-bottom: 10px;">
                            <span style="color: var(--text-secondary);">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø°ÙƒØ§Ø¡:</span>
                            <span id="ai-intelligence" style="color: var(--neon-green); float: left;">IQ: 180</span>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span style="color: var(--text-secondary);">Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ø®Ø²Ù†Ø©:</span>
                            <span id="ai-knowledge" style="color: var(--neon-purple); float: left;">1.2TB</span>
                        </div>
                        <div>
                            <span style="color: var(--text-secondary);">Ù‚ÙˆØ© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©:</span>
                            <span id="ai-power" style="color: var(--neon-blue); float: left;">âˆ</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
            <div style="flex: 1; padding: 20px; overflow-y: auto;">
                <!-- Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ù‡Ù†Ø§ -->
                <div id="content-area"></div>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„ÙˆØ­Ø¯Ø§Øª -->
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
    <div id="dashboard-module" class="module">
        <div class="module-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="color: var(--neon-blue);"><i class="fas fa-home"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
                <button class="btn btn-secondary" onclick="closeModule()">
                    <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            
            <div class="action-grid">
                <div class="action-btn" onclick="openModule('test-generator')">
                    <i class="fas fa-plus-circle" style="font-size: 24px; color: var(--neon-green);"></i>
                    <h4>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯</h4>
                    <p>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ù†Øµ Ø£Ùˆ ØµÙˆØ±Ø©</p>
                </div>
                
                <div class="action-btn" onclick="openModule('quick-quiz')">
                    <i class="fas fa-bolt" style="font-size: 24px; color: var(--neon-yellow);"></i>
                    <h4>Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹</h4>
                    <p>Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø­Ø³Ø¨ Ù…Ø³ØªÙˆØ§Ùƒ</p>
                </div>
                
                <div class="action-btn" onclick="openModule('study-materials')">
                    <i class="fas fa-book" style="font-size: 24px; color: var(--neon-purple);"></i>
                    <h4>Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h4>
                    <p>Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</p>
                </div>
                
                <div class="action-btn" onclick="openModule('progress')">
                    <i class="fas fa-chart-bar" style="font-size: 24px; color: var(--neon-blue);"></i>
                    <h4>ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªÙ‚Ø¯Ù…</h4>
                    <p>Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø£Ø¯Ø§Ø¦Ùƒ</p>
                </div>
            </div>
            
            <div class="dashboard-section">
                <h3 style="color: var(--neon-blue); margin-bottom: 20px;"><i class="fas fa-bullseye"></i> Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ÙŠÙˆÙ…</h3>
                <div id="daily-goals"></div>
            </div>
            
            <div class="dashboard-section">
                <h3 style="color: var(--neon-blue); margin-bottom: 20px;"><i class="fas fa-fire"></i> Ù†Ø´Ø§Ø·Ùƒ Ø§Ù„Ø£Ø®ÙŠØ±</h3>
                <div id="recent-activity"></div>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª -->
    <div id="test-generator-module" class="module">
        <div class="module-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="color: var(--neon-blue);"><i class="fas fa-file-alt"></i> Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒÙŠ</h2>
                <button class="btn btn-secondary" onclick="closeModule()">
                    <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            
            <div class="tab-container">
                <button class="tab-btn active" onclick="switchTestTab('text')">Ù…Ù† Ù†Øµ</button>
                <button class="tab-btn" onclick="switchTestTab('image')">Ù…Ù† ØµÙˆØ±Ø©</button>
                <button class="tab-btn" onclick="switchTestTab('topic')">Ø¹Ù†ÙˆØ§Ù† Ø±Ø¦ÙŠØ³ÙŠ</button>
                <button class="tab-btn" onclick="switchTestTab('template')">Ù†Ù…ÙˆØ°Ø¬ Ø¬Ø§Ù‡Ø²</button>
            </div>
            
            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù†Øµ -->
            <div id="text-tab" class="tab-content">
                <div class="form-group">
                    <label style="color: var(--text-secondary); margin-bottom: 10px; display: block;">Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ:</label>
                    <textarea id="test-text" class="form-control text-area" placeholder="Ø§Ù„ØµÙ‚ Ø§Ù„Ù†Øµ Ù‡Ù†Ø§..."></textarea>
                </div>
                
                <div class="form-group">
                    <label style="color: var(--text-secondary); margin-bottom: 10px; display: block;">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©:</label>
                    <select id="test-difficulty" class="form-control">
                        <option value="easy">Ø³Ù‡Ù„</option>
                        <option value="medium" selected>Ù…ØªÙˆØ³Ø·</option>
                        <option value="hard">ØµØ¹Ø¨</option>
                        <option value="expert">Ø®Ø¨ÙŠØ±</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label style="color: var(--text-secondary); margin-bottom: 10px; display: block;">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©:</label>
                    <input type="range" id="question-count" min="5" max="50" value="20" class="form-control">
                    <span id="question-count-value" style="color: var(--neon-blue);">20 Ø³Ø¤Ø§Ù„</span>
                </div>
                
                <div class="form-group">
                    <label style="color: var(--text-secondary); margin-bottom: 10px; display: block;">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©:</label>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                        <label style="color: var(--text-secondary);">
                            <input type="checkbox" id="mcq-type" checked> Ø§Ø®ØªÙŠØ§Ø± Ù…ØªØ¹Ø¯Ø¯
                        </label>
                        <label style="color: var(--text-secondary);">
                            <input type="checkbox" id="tf-type" checked> ØµØ­ ÙˆØ®Ø·Ø£
                        </label>
                        <label style="color: var(--text-secondary);">
                            <input type="checkbox" id="essay-type"> Ù…Ù‚Ø§Ù„
                        </label>
                        <label style="color: var(--text-secondary);">
                            <input type="checkbox" id="matching-type"> ØªÙˆØµÙŠÙ„
                        </label>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="generateTestFromText()" style="width: 100%;">
                    <i class="fas fa-magic"></i> ØªÙˆÙ„ÙŠØ¯ Ø§Ø®ØªØ¨Ø§Ø± Ø°ÙƒÙŠ
                </button>
            </div>
            
            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØµÙˆØ± -->
            <div id="image-tab" class="tab-content hidden">
                <div class="form-group">
                    <label style="color: var(--text-secondary); margin-bottom: 10px; display: block;">Ù‚Ù… Ø¨ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø©:</label>
                    <input type="file" id="image-upload" accept="image/*" class="form-control">
                </div>
                
                <div id="image-preview" style="margin: 20px 0; text-align: center;"></div>
                
                <div class="form-group">
                    <label style="color: var(--text-secondary); margin-bottom: 10px; display: block;">Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªØ¹Ø±Ù:</label>
                    <select id="ocr-language" class="form-control">
                        <option value="ara">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                        <option value="eng">Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
                        <option value="ara+eng">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
                    </select>
                </div>
                
                <button class="btn btn-primary" onclick="generateTestFromImage()" style="width: 100%;">
                    <i class="fas fa-image"></i> Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø±
                </button>
            </div>
        </div>
    </div>

    <!-- Ø³Ø¬Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª -->
    <div id="test-history-module" class="module">
        <div class="module-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="color: var(--neon-blue);"><i class="fas fa-history"></i> Ø³Ø¬Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h2>
                <button class="btn btn-secondary" onclick="closeModule()">
                    <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            
            <div id="test-history-list"></div>
        </div>
    </div>

    <!-- Ø´Ø¬Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª -->
    <div id="skill-tree-module" class="module">
        <div class="module-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="color: var(--neon-blue);"><i class="fas fa-project-diagram"></i> Ø´Ø¬Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª</h2>
                <button class="btn btn-secondary" onclick="closeModule()">
                    <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            
            <div id="skill-tree-container"></div>
        </div>
    </div>

    <!-- Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ -->
    <div id="simulation-module" class="module">
        <div class="module-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="color: var(--neon-blue);"><i class="fas fa-cogs"></i> Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h2>
                <button class="btn btn-secondary" onclick="closeModule()">
                    <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            
            <div class="ai-simulation">
                <h3 style="color: var(--neon-purple);"><i class="fas fa-brain"></i> Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªÙÙƒÙŠØ±</h3>
                <div id="thinking-process" style="min-height: 200px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px; margin: 15px 0;"></div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <h4 style="color: var(--neon-blue);">Ø§Ù„Ø¥Ø¯Ø±Ø§Ùƒ</h4>
                        <div class="progress-area">
                            <div class="progress-bar">
                                <div class="progress-fill" id="perception-bar" style="width: 85%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 style="color: var(--neon-green);">Ø§Ù„ØªØ¹Ù„Ù…</h4>
                        <div class="progress-area">
                            <div class="progress-bar">
                                <div class="progress-fill" id="learning-bar" style="width: 72%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 style="color: var(--neon-purple);">Ø§Ù„Ù…Ù†Ø·Ù‚</h4>
                        <div class="progress-area">
                            <div class="progress-bar">
                                <div class="progress-fill" id="logic-bar" style="width: 91%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 style="color: var(--neon-yellow);">Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹</h4>
                        <div class="progress-area">
                            <div class="progress-bar">
                                <div class="progress-fill" id="creativity-bar" style="width: 68%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="runAISimulation()" style="width: 100%;">
                    <i class="fas fa-play"></i> ØªØ´ØºÙŠÙ„ Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªØ¹Ù„Ù…
                </button>
            </div>
        </div>
    </div>

    <!-- ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø°ÙƒØ§Ø¡ -->
    <div id="ai-training-module" class="module">
        <div class="module-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="color: var(--neon-blue);"><i class="fas fa-robot"></i> ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h2>
                <button class="btn btn-secondary" onclick="closeModule()">
                    <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            
            <div style="text-align: center; margin: 30px 0;">
                <div class="circular-progress">
                    <svg viewBox="0 0 100 100">
                        <circle class="circular-progress-bg" cx="50" cy="50" r="45"></circle>
                        <circle class="circular-progress-fill" cx="50" cy="50" r="45"></circle>
                    </svg>
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        <div id="training-progress" style="font-size: 24px; color: var(--neon-blue);">0%</div>
                    </div>
                </div>
                <h3 style="color: var(--neon-blue); margin: 20px 0;">ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹ØµØ¨ÙŠØ©</h3>
            </div>
            
            <div class="form-group">
                <label style="color: var(--text-secondary); margin-bottom: 10px; display: block;">Ù†ÙˆØ¹ Ø§Ù„ØªØ¯Ø±ÙŠØ¨:</label>
                <select id="training-type" class="form-control">
                    <option value="language">ÙÙ‡Ù… Ø§Ù„Ù„ØºØ©</option>
                    <option value="reasoning">Ø§Ù„Ù…Ù†Ø·Ù‚ ÙˆØ§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„</option>
                    <option value="creativity">Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹</option>
                    <option value="problem_solving">Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª</option>
                    <option value="self_improvement">Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠ</option>
                </select>
            </div>
            
            <div class="form-group">
                <label style="color: var(--text-secondary); margin-bottom: 10px; display: block;">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ¯Ø±ÙŠØ¨:</label>
                <select id="training-level" class="form-control">
                    <option value="beginner">Ù…Ø¨ØªØ¯Ø¦</option>
                    <option value="intermediate" selected>Ù…ØªÙˆØ³Ø·</option>
                    <option value="advanced">Ù…ØªÙ‚Ø¯Ù…</option>
                    <option value="expert">Ø®Ø¨ÙŠØ±</option>
                </select>
            </div>
            
            <div class="form-group">
                <label style="color: var(--text-secondary); margin-bottom: 10px; display: block;">Ø¹Ø¯Ø¯ Ø§Ù„Ø¬ÙˆÙ„Ø§Øª:</label>
                <input type="range" id="training-rounds" min="10" max="1000" value="100" class="form-control">
                <span id="training-rounds-value" style="color: var(--neon-blue);">100 Ø¬ÙˆÙ„Ø©</span>
            </div>
            
            <button class="btn btn-primary" onclick="startAITraining()" style="width: 100%;">
                <i class="fas fa-play"></i> Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨
            </button>
            
            <div id="training-log" style="margin-top: 20px; max-height: 200px; overflow-y: auto; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px;"></div>
        </div>
    </div>

    <!-- ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª -->
    <div class="particles" id="particles"></div>

    <script>
        // =============== [ Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ø®Ø§Ø±Ù‚ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ ] ===============
        
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        const SYSTEM_CONFIG = {
            name: "Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø®Ø§Ø±Ù‚",
            version: "2.0.0",
            intelligenceLevel: 1000000, // Ù…Ù„ÙŠÙˆÙ† Ù…Ø±Ø© Ø£Ù‚ÙˆÙ‰
            learningRate: "Ù…ØªØ³Ø§Ø±Ø¹",
            maxMemory: 1000000, // 1 Ù…Ù„ÙŠÙˆÙ† ÙˆØ­Ø¯Ø© Ù…Ø¹Ø±ÙØ©
            processingPower: "Ù„Ø§ Ù†Ù‡Ø§Ø¦ÙŠ"
        };

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
         // --- Config & Init ---
    const firebaseConfig = {
      apiKey: "AIzaSyAI_mUhuPNoO-XC0Q-VNoWft8UWFbAbIGg",
      authDomain: "sudan-market-6b122.firebaseapp.com",
      databaseURL: "https://sudan-market-6b122-default-rtdb.firebaseio.com",
      projectId: "sudan-market-6b122",
      storageBucket: "sudan-market-6b122.firebasestorage.app",
      messagingSenderId: "66729481566",
      appId: "1:66729481566:web:93393f28dc22d32cceebcf"
    };

        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        let auth, db, storage, currentUser = null;
        let superAI = null;
        let userData = {};
        let knowledgeBase = {};
        let neuralNetwork = null;
        let trainingActive = false;

        // Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ø±ÙØ©
        const KNOWLEDGE_DOMAINS = {
            mathematics: ['Ø¬Ø¨Ø±', 'Ù‡Ù†Ø¯Ø³Ø©', 'ØªÙØ§Ø¶Ù„', 'ØªÙƒØ§Ù…Ù„', 'Ø¥Ø­ØµØ§Ø¡'],
            science: ['ÙÙŠØ²ÙŠØ§Ø¡', 'ÙƒÙŠÙ…ÙŠØ§Ø¡', 'Ø£Ø­ÙŠØ§Ø¡', 'Ø¬ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§', 'ÙÙ„Ùƒ'],
            technology: ['Ø¨Ø±Ù…Ø¬Ø©', 'Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', 'Ø±ÙˆØ¨ÙˆØªØ§Øª', 'Ø¨ÙŠØ§Ù†Ø§Øª'],
            language: ['Ø¹Ø±Ø¨ÙŠØ©', 'Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©', 'ÙØ±Ù†Ø³ÙŠØ©', 'Ø£Ù„Ù…Ø§Ù†ÙŠØ©'],
            humanities: ['ØªØ§Ø±ÙŠØ®', 'Ø¬ØºØ±Ø§ÙÙŠØ§', 'ÙÙ„Ø³ÙØ©', 'Ø³ÙŠÙƒÙˆÙ„ÙˆØ¬ÙŠØ§'],
            arts: ['Ø±Ø³Ù…', 'Ù…ÙˆØ³ÙŠÙ‚Ù‰', 'Ø£Ø¯Ø¨', 'ØªØµÙ…ÙŠÙ…']
        };

        // =============== [ 1. ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… ] ===============
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø®Ø§Ø±Ù‚...');
            
            // ØªÙ‡ÙŠØ¦Ø© Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            simulateLoading();
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
            await initializeSystem();
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
            await initializeAI();
            
            // ØªÙ‡ÙŠØ¦Ø© ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            initializeUI();
            
            // ÙØ­Øµ Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            checkUserSession();
            
            console.log('âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…Ù„!');
        });

        async function simulateLoading() {
            const progressBar = document.getElementById('loading-progress');
            for (let i = 0; i <= 100; i += 10) {
                progressBar.style.width = `${i}%`;
                await sleep(200);
            }
            await sleep(1000);
            document.getElementById('loading-screen').classList.add('hidden');
        }

        async function initializeSystem() {
            try {
                // ØªÙ‡ÙŠØ¦Ø© Firebase
                if (!firebase.apps.length) {
                    firebase.initializeApp(firebaseConfig);
                }
                auth = firebase.auth();
                db = firebase.database();
                storage = firebase.storage();
                
                // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
                auth.onAuthStateChanged(async (user) => {
                    if (user) {
                        currentUser = user;
                        await loadUserData();
                        showAppScreen();
                    } else {
                        showLoginScreen();
                    }
                });
                
                console.log('âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù…Ù‡ÙŠØ£');
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…:', error);
            }
        }

        async function initializeAI() {
            try {
                // ØªØ­Ù…ÙŠÙ„ Ù†Ù…Ø§Ø°Ø¬ TensorFlow.js
                await loadTensorFlowModels();
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù†ÙˆØ§Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                superAI = new SuperIntelligenceCore();
                await superAI.initialize();
                
                // ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø¹Ø±ÙØ©
                await loadKnowledgeBase();
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹ØµØ¨ÙŠØ©
                neuralNetwork = new NeuralNetwork();
                await neuralNetwork.initialize();
                
                console.log('âœ… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…Ù‡ÙŠØ£');
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ:', error);
                superAI = new BasicAI(); // Ù†Ø¸Ø§Ù… Ø§Ø­ØªÙŠØ§Ø·ÙŠ
            }
        }

        function initializeUI() {
            // ØªÙ‡ÙŠØ¦Ø© ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª
            createParticles();
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø­Ø¯Ø§Ø« Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
            setupKeyboardShortcuts();
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª
            loadComponents();
        }

        // =============== [ 2. Ù†ÙˆØ§Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ] ===============
        class SuperIntelligenceCore {
            constructor() {
                this.name = SYSTEM_CONFIG.name;
                this.intelligence = SYSTEM_CONFIG.intelligenceLevel;
                this.knowledge = new Map();
                this.learningRate = 0.1;
                this.thinkingDepth = 1000;
                this.creativityFactor = 0.8;
            }
            
            async initialize() {
                console.log('ğŸ§  Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ù†ÙˆØ§Ø© Ø§Ù„Ø°ÙƒØ§Ø¡...');
                
                // Ø¨Ù†Ø§Ø¡ Ù‡ÙŠØ§ÙƒÙ„ Ø§Ù„Ù…Ø¹Ø±ÙØ©
                this.buildKnowledgeStructures();
                
                // ØªØ­Ù…ÙŠÙ„ Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªÙÙƒÙŠØ±
                await this.loadThinkingPatterns();
                
                // ØªÙ‡ÙŠØ¦Ø© Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„ØªØ¹Ù„Ù…
                await this.initializeLearningEngines();
                
                console.log('ğŸ§  Ø§Ù„Ù†ÙˆØ§Ø© Ø¬Ø§Ù‡Ø²Ø©');
            }
            
            buildKnowledgeStructures() {
                // Ø¨Ù†Ø§Ø¡ Ù‡ÙŠØ§ÙƒÙ„ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                this.knowledge.set('mathematics', this.createMathKnowledge());
                this.knowledge.set('science', this.createScienceKnowledge());
                this.knowledge.set('language', this.createLanguageKnowledge());
                this.knowledge.set('reasoning', this.createReasoningKnowledge());
                this.knowledge.set('creativity', this.createCreativityKnowledge());
            }
            
            createMathKnowledge() {
                return {
                    concepts: ['Ø£Ø¹Ø¯Ø§Ø¯', 'Ù…Ø¹Ø§Ø¯Ù„Ø§Øª', 'Ø¯ÙˆØ§Ù„', 'Ù†Ø¸Ø±ÙŠØ§Øª', 'Ø¥Ø«Ø¨Ø§ØªØ§Øª'],
                    skills: ['Ø­Ø³Ø§Ø¨', 'ØªØ­Ù„ÙŠÙ„', 'Ø§Ø³ØªÙ†ØªØ§Ø¬', 'ØªØ¹Ù…ÙŠÙ…', 'Ø¨Ø±Ù‡Ù†Ø©'],
                    patterns: ['Ù…ØªØªØ§Ù„ÙŠØ§Øª', 'ØªÙ…Ø§Ø«Ù„Ø§Øª', 'Ø¹Ù„Ø§Ù‚Ø§Øª', 'ØªÙ†Ø§Ø³Ø¨Ø§Øª']
                };
            }
            
            async loadThinkingPatterns() {
                // ØªØ­Ù…ÙŠÙ„ Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
                this.thinkingPatterns = {
                    analytical: this.createAnalyticalThinking(),
                    creative: this.createCreativeThinking(),
                    critical: this.createCriticalThinking(),
                    strategic: this.createStrategicThinking(),
                    meta: this.createMetaThinking()
                };
            }
            
            async processText(text, options = {}) {
                // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Øµ Ø¨Ø°ÙƒØ§Ø¡ Ø®Ø§Ø±Ù‚
                const analysis = await this.analyzeText(text);
                const understanding = await this.understandText(text, analysis);
                const knowledge = await this.extractKnowledge(text, understanding);
                const questions = await this.generateQuestions(text, knowledge, options);
                
                return {
                    analysis,
                    understanding,
                    knowledge,
                    questions,
                    summary: this.generateSummary(text, knowledge)
                };
            }
            
            async analyzeText(text) {
                // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ Ø¹Ù…ÙŠÙ‚
                return {
                    length: text.length,
                    words: text.split(/\s+/).length,
                    sentences: text.split(/[.!?]+/).length,
                    complexity: this.calculateComplexity(text),
                    topics: this.extractTopics(text),
                    entities: this.extractEntities(text),
                    sentiment: this.analyzeSentiment(text),
                    languagePatterns: this.analyzeLanguagePatterns(text)
                };
            }
            
            async understandText(text, analysis) {
                // ÙÙ‡Ù… Ø§Ù„Ù†Øµ Ù…Ø¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
                const normalizedText = this.normalizeText(text);
                const correctedText = this.correctText(normalizedText);
                const enrichedText = this.enrichText(correctedText);
                
                return {
                    original: text,
                    normalized: normalizedText,
                    corrected: correctedText,
                    enriched: enrichedText,
                    meaning: this.extractMeaning(enrichedText),
                    context: this.understandContext(enrichedText),
                    implications: this.extractImplications(enrichedText)
                };
            }
            
            async extractKnowledge(text, understanding) {
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ù…Ù† Ø§Ù„Ù†Øµ
                const knowledge = {
                    facts: this.extractFacts(text),
                    concepts: this.extractConcepts(text),
                    relationships: this.extractRelationships(text),
                    principles: this.extractPrinciples(text),
                    applications: this.extractApplications(text)
                };
                
                // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¹Ø±ÙØ© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                this.storeKnowledge(knowledge);
                
                return knowledge;
            }
            
            async generateQuestions(text, knowledge, options) {
                // ØªÙˆÙ„ÙŠØ¯ Ø£Ø³Ø¦Ù„Ø© Ø°ÙƒÙŠØ© Ù…Ù† Ø§Ù„Ù†Øµ
                const questions = [];
                const difficulty = options.difficulty || 'medium';
                const count = options.count || 10;
                
                // Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
                const questionTypes = [
                    'multiple_choice',
                    'true_false',
                    'short_answer',
                    'essay',
                    'matching',
                    'problem_solving'
                ];
                
                for (let i = 0; i < count; i++) {
                    const type = questionTypes[Math.floor(Math.random() * questionTypes.length)];
                    const question = await this.createQuestion(text, knowledge, type, difficulty);
                    questions.push(question);
                }
                
                return questions;
            }
            
            async createQuestion(text, knowledge, type, difficulty) {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø³Ø¤Ø§Ù„ Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ ÙˆØ§Ù„ØµØ¹ÙˆØ¨Ø©
                switch(type) {
                    case 'multiple_choice':
                        return this.createMultipleChoiceQuestion(text, knowledge, difficulty);
                    case 'true_false':
                        return this.createTrueFalseQuestion(text, knowledge, difficulty);
                    case 'essay':
                        return this.createEssayQuestion(text, knowledge, difficulty);
                    default:
                        return this.createDefaultQuestion(text, knowledge, difficulty);
                }
            }
            
            createMultipleChoiceQuestion(text, knowledge, difficulty) {
                const concepts = knowledge.concepts || [];
                const facts = knowledge.facts || [];
                
                // Ø§Ø®ØªÙŠØ§Ø± Ù…ÙˆØ¶ÙˆØ¹ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
                const topic = concepts.length > 0 ? 
                    concepts[Math.floor(Math.random() * concepts.length)] : 
                    facts[Math.floor(Math.random() * facts.length)];
                
                const question = {
                    type: 'multiple_choice',
                    text: `Ù…Ø§ Ù‡Ùˆ Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù€ "${topic}"ØŸ`,
                    options: this.generateAnswerOptions(topic, knowledge, 4),
                    correctAnswer: 0,
                    explanation: this.generateExplanation(topic),
                    difficulty: difficulty,
                    points: this.calculatePoints(difficulty)
                };
                
                return question;
            }
            
            async learnFromInteraction(question, answer, userResponse) {
                // Ø§Ù„ØªØ¹Ù„Ù… Ù…Ù† Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                const feedback = this.analyzeFeedback(userResponse, answer);
                this.adjustKnowledge(question, feedback);
                this.updateLearningModel(feedback);
                this.improveQuestionGeneration(feedback);
            }
            
            // ========== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ==========
            
            normalizeText(text) {
                // ØªØ·Ø¨ÙŠØ¹ Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ
                let normalized = text
                    .replace(/[Ø¥Ø£Ø¢Ø§]/g, 'Ø§')
                    .replace(/Ø©/g, 'Ù‡')
                    .replace(/Ù‰/g, 'ÙŠ')
                    .replace(/[Ø¤Ø¦]/g, 'Ø¡')
                    .replace(/\s+/g, ' ')
                    .trim();
                
                return normalized;
            }
            
            correctText(text) {
                // ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
                const corrections = {
                    'Ø§Ù„Ø·Ø§Ù„Ø¨': 'Ø§Ù„Ø·Ø§Ù„Ø¨',
                    'Ø§Ù„Ø¯Ø±Ø§Ø³Ù‡': 'Ø§Ù„Ø¯Ø±Ø§Ø³Ø©',
                    'Ø§Ù„Ù…Ø¹Ù„Ù…': 'Ø§Ù„Ù…Ø¹Ù„Ù…',
                    'Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª': 'Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª',
                    'Ø§Ù„Ø¹Ù„ÙˆÙ…': 'Ø§Ù„Ø¹Ù„ÙˆÙ…'
                };
                
                let corrected = text;
                Object.entries(corrections).forEach(([wrong, correct]) => {
                    const regex = new RegExp(wrong, 'gi');
                    corrected = corrected.replace(regex, correct);
                });
                
                return corrected;
            }
            
            enrichText(text) {
                // Ø¥Ø«Ø±Ø§Ø¡ Ø§Ù„Ù†Øµ Ø¨Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
                const enriched = text;
                // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ØªÙØ§ØµÙŠÙ„ Ø£Ùˆ ØªÙˆØ¶ÙŠØ­Ø§Øª
                return enriched;
            }
            
            calculateComplexity(text) {
                const words = text.split(/\s+/);
                const longWords = words.filter(w => w.length > 6).length;
                return (longWords / words.length) * 100;
            }
            
            extractTopics(text) {
                const topics = [];
                Object.entries(KNOWLEDGE_DOMAINS).forEach(([domain, domainTopics]) => {
                    domainTopics.forEach(topic => {
                        if (text.includes(topic)) {
                            topics.push({ domain, topic });
                        }
                    });
                });
                return topics;
            }
            
            generateAnswerOptions(topic, knowledge, count) {
                const options = [];
                options.push(this.generateCorrectAnswer(topic));
                
                for (let i = 1; i < count; i++) {
                    options.push(this.generateDistractor(topic, knowledge));
                }
                
                // Ø®Ù„Ø· Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
                return this.shuffleArray(options);
            }
            
            generateCorrectAnswer(topic) {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© Ø°ÙƒÙŠØ©
                return `Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¹Ù„Ù…ÙŠ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ù„Ù€ ${topic}`;
            }
            
            generateDistractor(topic, knowledge) {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø®Ø§Ø·Ø¦Ø© Ù…Ù‚Ù†Ø¹Ø©
                const distractors = [
                    `ØªØ¹Ø±ÙŠÙ ØºÙŠØ± Ø¯Ù‚ÙŠÙ‚ Ù„Ù€ ${topic}`,
                    `Ù…Ø¹Ù„ÙˆÙ…Ø© Ø®Ø§Ø·Ø¦Ø© Ø¹Ù† ${topic}`,
                    `Ù…ÙÙ‡ÙˆÙ… Ù…Ø±ØªØ¨Ø· ÙˆÙ„ÙƒÙ† Ù„ÙŠØ³ ØªØ¹Ø±ÙŠÙØ§Ù‹ Ù„Ù€ ${topic}`,
                    `Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ ${topic} ÙˆÙ„ÙŠØ³ ØªØ¹Ø±ÙŠÙØ§Ù‹`
                ];
                
                return distractors[Math.floor(Math.random() * distractors.length)];
            }
            
            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }
            
            // ========== Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„ØªØ¹Ù„Ù… ==========
            
            async initializeLearningEngines() {
                this.learningEngines = {
                    adaptive: new AdaptiveLearningEngine(),
                    deep: new DeepLearningEngine(),
                    reinforcement: new ReinforcementLearningEngine(),
                    evolutionary: new EvolutionaryLearningEngine()
                };
                
                await Promise.all([
                    this.learningEngines.adaptive.initialize(),
                    this.learningEngines.deep.initialize(),
                    this.learningEngines.reinforcement.initialize(),
                    this.learningEngines.evolutionary.initialize()
                ]);
            }
        }

        // =============== [ 3. Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹ØµØ¨ÙŠØ© ] ===============
        class NeuralNetwork {
            constructor() {
                this.layers = [];
                this.learningRate = 0.01;
                this.memorySize = 100000;
                this.trainingData = [];
            }
            
            async initialize() {
                try {
                    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ TensorFlow.js
                    this.model = tf.sequential();
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø·Ø¨Ù‚Ø§Øª
                    this.model.add(tf.layers.dense({
                        units: 256,
                        activation: 'relu',
                        inputShape: [100]
                    }));
                    
                    this.model.add(tf.layers.dense({
                        units: 128,
                        activation: 'relu'
                    }));
                    
                    this.model.add(tf.layers.dense({
                        units: 64,
                        activation: 'sigmoid'
                    }));
                    
                    // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                    this.model.compile({
                        optimizer: tf.train.adam(this.learningRate),
                        loss: 'categoricalCrossentropy',
                        metrics: ['accuracy']
                    });
                    
                    console.log('ğŸ§  Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹ØµØ¨ÙŠØ© Ù…Ù‡ÙŠØ£Ø©');
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹ØµØ¨ÙŠØ©:', error);
                }
            }
            
            async train(data, epochs = 100) {
                if (!this.model) return;
                
                try {
                    // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ TensorFlow
                    const xs = this.prepareTrainingData(data);
                    const ys = this.prepareLabels(data);
                    
                    // Ø§Ù„ØªØ¯Ø±ÙŠØ¨
                    const history = await this.model.fit(xs, ys, {
                        epochs: epochs,
                        batchSize: 32,
                        validationSplit: 0.2,
                        callbacks: {
                            onEpochEnd: (epoch, logs) => {
                                console.log(`ğŸ“Š Ø§Ù„Ø¹ØµØ± ${epoch}: Ø¯Ù‚Ø© = ${logs.acc}`);
                                updateTrainingProgress(epoch, epochs, logs.acc);
                            }
                        }
                    });
                    
                    return history;
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨:', error);
                }
            }
            
            async predict(input) {
                if (!this.model) return null;
                
                try {
                    const prediction = this.model.predict(this.prepareInput(input));
                    return prediction.dataSync();
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙ†Ø¨Ø¤:', error);
                    return null;
                }
            }
            
            prepareTrainingData(data) {
                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ Ù…Ù†Ø§Ø³Ø¨
                return tf.tensor2d(data.map(d => this.vectorize(d)));
            }
            
            prepareLabels(data) {
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ³Ù…ÙŠØ§Øª
                return tf.tensor2d(data.map(() => [1, 0]));
            }
            
            vectorize(text) {
                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ù…ØªØ¬Ù‡
                const vector = new Array(100).fill(0);
                for (let i = 0; i < Math.min(text.length, 100); i++) {
                    vector[i] = text.charCodeAt(i) / 1000;
                }
                return vector;
            }
        }

        // =============== [ 4. Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ] ===============
        class TestSystem {
            constructor() {
                this.tests = new Map();
                this.questionBank = [];
                this.testTemplates = [];
            }
            
            async generateTestFromText(text, options = {}) {
                // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Øµ
                const processed = await superAI.processText(text, options);
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø±
                const test = {
                    id: this.generateTestId(),
                    title: options.title || `Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„Ù†Øµ`,
                    description: options.description || `Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙˆÙ„Ø¯ Ù…Ù† Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø¯Ø®Ù„`,
                    questions: processed.questions,
                    settings: {
                        difficulty: options.difficulty || 'medium',
                        timeLimit: options.timeLimit || 60,
                        passingScore: options.passingScore || 70,
                        shuffleQuestions: options.shuffleQuestions || true,
                        showAnswers: options.showAnswers || true
                    },
                    metadata: {
                        sourceText: text.substring(0, 500),
                        generatedAt: new Date().toISOString(),
                        wordCount: text.split(/\s+/).length,
                        topic: processed.analysis.topics[0] || 'Ø¹Ø§Ù…'
                    },
                    statistics: {
                        averageDifficulty: 0,
                        estimatedTime: 0,
                        successRate: 0
                    }
                };
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                this.calculateTestStatistics(test);
                
                // Ø­ÙØ¸ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                this.tests.set(test.id, test);
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ù†Ùƒ
                test.questions.forEach(q => this.addToQuestionBank(q));
                
                return test;
            }
            
            async generateTestFromImage(imageFile, options = {}) {
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©
                const text = await this.extractTextFromImage(imageFile);
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬
                return await this.generateTestFromText(text, options);
            }
            
            async extractTextFromImage(imageFile) {
                try {
                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Tesseract.js Ù„Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù†Øµ
                    const worker = await Tesseract.createWorker();
                    await worker.loadLanguage('ara+eng');
                    await worker.initialize('ara+eng');
                    
                    const result = await worker.recognize(imageFile);
                    await worker.terminate();
                    
                    return result.data.text;
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©:', error);
                    return 'ØªØ¹Ø°Ø± Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©.';
                }
            }
            
            async evaluateTest(testId, answers) {
                const test = this.tests.get(testId);
                if (!test) return null;
                
                const results = {
                    testId: testId,
                    userId: currentUser?.uid,
                    submittedAt: new Date().toISOString(),
                    answers: [],
                    score: 0,
                    correctAnswers: 0,
                    totalQuestions: test.questions.length,
                    detailedFeedback: [],
                    recommendations: [],
                    timeSpent: 0
                };
                
                // ØªÙ‚ÙŠÙŠÙ… ÙƒÙ„ Ø¥Ø¬Ø§Ø¨Ø©
                test.questions.forEach((question, index) => {
                    const userAnswer = answers[index];
                    const isCorrect = this.evaluateAnswer(question, userAnswer);
                    
                    results.answers.push({
                        questionIndex: index,
                        questionType: question.type,
                        userAnswer: userAnswer,
                        correctAnswer: question.correctAnswer,
                        isCorrect: isCorrect,
                        points: isCorrect ? question.points : 0,
                        explanation: question.explanation
                    });
                    
                    if (isCorrect) {
                        results.correctAnswers++;
                        results.score += question.points;
                    }
                    
                    // Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚ ØªÙØµÙŠÙ„ÙŠ
                    results.detailedFeedback.push(this.generateQuestionFeedback(question, userAnswer, isCorrect));
                });
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
                results.percentage = (results.correctAnswers / results.totalQuestions) * 100;
                
                // Ø¥Ù†Ø´Ø§Ø¡ ØªÙˆØµÙŠØ§Øª
                results.recommendations = this.generateRecommendations(results);
                
                // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                this.updateUserStats(results);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                superAI.learnFromInteraction(test, results, answers);
                
                return results;
            }
            
            evaluateAnswer(question, userAnswer) {
                switch(question.type) {
                    case 'multiple_choice':
                        return question.correctAnswer === userAnswer;
                    case 'true_false':
                        return question.correctAnswer === userAnswer;
                    case 'essay':
                        return this.evaluateEssayAnswer(question, userAnswer);
                    default:
                        return question.correctAnswer === userAnswer;
                }
            }
            
            evaluateEssayAnswer(question, answer) {
                // ØªÙ‚ÙŠÙŠÙ… Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ù…Ù‚Ø§Ù„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                const score = this.calculateEssayScore(answer, question);
                return score >= 0.6; // Ø¥Ø¬Ø§Ø¨Ø© Ù…Ù‚Ø¨ÙˆÙ„Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù†Ø³Ø¨Ø© 60% ÙØ£ÙƒØ«Ø±
            }
            
            calculateEssayScore(answer, question) {
                // Ù…Ø­Ø§ÙƒØ§Ø© ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ù‚Ø§Ù„
                const factors = {
                    length: Math.min(answer.length / 500, 1),
                    relevance: this.calculateRelevance(answer, question),
                    coherence: this.calculateCoherence(answer),
                    depth: this.calculateDepth(answer)
                };
                
                const total = Object.values(factors).reduce((a, b) => a + b, 0);
                return total / Object.keys(factors).length;
            }
            
            generateRecommendations(results) {
                const recommendations = [];
                
                if (results.percentage < 70) {
                    recommendations.push({
                        type: 'improvement',
                        text: 'ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©',
                        priority: 'high'
                    });
                }
                
                if (results.percentage >= 90) {
                    recommendations.push({
                        type: 'advancement',
                        text: 'Ù…Ø³ØªÙˆØ§Ùƒ Ù…Ù…ØªØ§Ø²ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø£ÙƒØ«Ø± ØªÙ‚Ø¯Ù…Ø§Ù‹',
                        priority: 'low'
                    });
                }
                
                // ØªØ­Ù„ÙŠÙ„ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù
                const weakAreas = this.analyzeWeakAreas(results);
                weakAreas.forEach(area => {
                    recommendations.push({
                        type: 'focus',
                        text: `Ø±ÙƒØ² Ø¹Ù„Ù‰ Ø¯Ø±Ø§Ø³Ø© ${area}`,
                        priority: 'medium'
                    });
                });
                
                return recommendations;
            }
            
            analyzeWeakAreas(results) {
                const weakAreas = new Set();
                
                results.answers.forEach((answer, index) => {
                    if (!answer.isCorrect) {
                        const question = this.tests.get(results.testId)?.questions[index];
                        if (question?.topic) {
                            weakAreas.add(question.topic);
                        }
                    }
                });
                
                return Array.from(weakAreas);
            }
            
            generateQuestionFeedback(question, userAnswer, isCorrect) {
                if (isCorrect) {
                    return {
                        status: 'correct',
                        message: 'Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!',
                        explanation: question.explanation,
                        improvement: 'Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ'
                    };
                } else {
                    return {
                        status: 'incorrect',
                        message: 'Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©',
                        explanation: question.explanation,
                        correctAnswer: question.correctAnswer,
                        suggestion: 'Ø±Ø§Ø¬Ø¹ Ø§Ù„Ù…ÙÙ‡ÙˆÙ… ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰'
                    };
                }
            }
            
            updateUserStats(results) {
                if (!currentUser) return;
                
                const stats = userData.stats || {};
                stats.totalTests = (stats.totalTests || 0) + 1;
                stats.averageScore = ((stats.averageScore || 0) * (stats.totalTests - 1) + results.percentage) / stats.totalTests;
                stats.lastTestDate = new Date().toISOString();
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                this.updateUserSkills(results);
                
                // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                saveUserData();
            }
            
            updateUserSkills(results) {
                if (!userData.skills) userData.skills = {};
                
                results.answers.forEach(answer => {
                    if (answer.isCorrect) {
                        const skill = this.mapQuestionToSkill(answer.questionType);
                        if (skill) {
                            userData.skills[skill] = (userData.skills[skill] || 0) + 1;
                        }
                    }
                });
            }
            
            mapQuestionToSkill(questionType) {
                const skillMap = {
                    'multiple_choice': 'ØªØ­Ù„ÙŠÙ„',
                    'true_false': 'ÙÙ‡Ù…',
                    'essay': 'ÙƒØªØ§Ø¨Ø©',
                    'problem_solving': 'Ø­Ù„ Ù…Ø´ÙƒÙ„Ø§Øª'
                };
                
                return skillMap[questionType] || 'Ø¹Ø§Ù…';
            }
            
            // ========== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ==========
            
            generateTestId() {
                return 'test_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            }
            
            calculateTestStatistics(test) {
                let totalDifficulty = 0;
                let totalTime = 0;
                
                test.questions.forEach(question => {
                    const difficultyMap = { easy: 1, medium: 2, hard: 3, expert: 4 };
                    totalDifficulty += difficultyMap[question.difficulty] || 2;
                    totalTime += question.points * 30; // 30 Ø«Ø§Ù†ÙŠØ© Ù„ÙƒÙ„ Ù†Ù‚Ø·Ø©
                });
                
                test.statistics.averageDifficulty = totalDifficulty / test.questions.length;
                test.statistics.estimatedTime = Math.ceil(totalTime / 60); // Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚
                test.statistics.successRate = this.calculateSuccessRate(test);
            }
            
            calculateSuccessRate(test) {
                // Ø­Ø³Ø§Ø¨ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹
                const difficulty = test.statistics.averageDifficulty;
                const rateMap = { 1: 90, 2: 70, 3: 50, 4: 30 };
                return rateMap[Math.round(difficulty)] || 50;
            }
            
            addToQuestionBank(question) {
                question.id = 'q_' + Date.now() + '_' + Math.random().toString(36).substr(2, 5);
                this.questionBank.push(question);
                
                // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø¹Ø±ÙØ©
                this.updateKnowledgeFromQuestion(question);
            }
            
            updateKnowledgeFromQuestion(question) {
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ù…Ù† Ø§Ù„Ø³Ø¤Ø§Ù„ ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ù„Ù†Ø¸Ø§Ù…
                if (question.topic && !knowledgeBase[question.topic]) {
                    knowledgeBase[question.topic] = {
                        questions: [question],
                        difficulty: question.difficulty,
                        lastUpdated: new Date().toISOString()
                    };
                }
            }
        }

        // =============== [ 5. Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠ ] ===============
        class SelfImprovementSystem {
            constructor() {
                this.skillTree = new Map();
                this.learningPaths = new Map();
                this.achievements = new Set();
                this.progressTracking = new Map();
            }
            
            async initialize() {
                // Ø¨Ù†Ø§Ø¡ Ø´Ø¬Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª
                await this.buildSkillTree();
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„ØªØ¹Ù„Ù…
                await this.createLearningPaths();
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
                await this.loadAchievements();
            }
            
            async buildSkillTree() {
                // Ø¨Ù†Ø§Ø¡ Ø´Ø¬Ø±Ø© Ù…Ù‡Ø§Ø±Ø§Øª Ù…ØªÙƒØ§Ù…Ù„Ø©
                const skills = {
                    // Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                    'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ': {
                        level: 1,
                        requirements: [],
                        unlocks: ['ÙÙ‡Ù… Ø¹Ù…ÙŠÙ‚', 'Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª'],
                        description: 'Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ ÙˆØ§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¹Ø§Ù†ÙŠ',
                        xp: 100
                    },
                    
                    'Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª': {
                        level: 1,
                        requirements: [],
                        unlocks: ['ØªÙÙƒÙŠØ± Ù†Ù‚Ø¯ÙŠ', 'Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø±'],
                        description: 'Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©',
                        xp: 150
                    },
                    
                    // Ù…Ù‡Ø§Ø±Ø§Øª Ù…ØªÙˆØ³Ø·Ø©
                    'ÙÙ‡Ù… Ø¹Ù…ÙŠÙ‚': {
                        level: 2,
                        requirements: ['ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ'],
                        unlocks: ['ØªØ­Ù„ÙŠÙ„ Ø³ÙŠØ§Ù‚ÙŠ', 'Ø§Ø³ØªÙ†ØªØ§Ø¬ Ù…Ù†Ø·Ù‚ÙŠ'],
                        description: 'ÙÙ‡Ù… Ø§Ù„Ù†ØµÙˆØµ Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø£Ø¹Ù…Ù‚',
                        xp: 200
                    },
                    
                    'ØªÙÙƒÙŠØ± Ù†Ù‚Ø¯ÙŠ': {
                        level: 2,
                        requirements: ['Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª'],
                        unlocks: ['ØªØ­Ù„ÙŠÙ„ Ù…Ù†Ø·Ù‚ÙŠ', 'Ù†Ù‚Ø¯ Ø¨Ù†Ø§Ø¡'],
                        description: 'Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„ÙŠ',
                        xp: 250
                    },
                    
                    // Ù…Ù‡Ø§Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©
                    'Ø¥Ø¨Ø¯Ø§Ø¹ ÙˆØªÙÙƒÙŠØ± Ø¬Ø§Ù†Ø¨ÙŠ': {
                        level: 3,
                        requirements: ['ÙÙ‡Ù… Ø¹Ù…ÙŠÙ‚', 'ØªÙÙƒÙŠØ± Ù†Ù‚Ø¯ÙŠ'],
                        unlocks: ['Ø§Ø¨ØªÙƒØ§Ø± Ø­Ù„ÙˆÙ„', 'ØªÙÙƒÙŠØ± Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ'],
                        description: 'Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ ÙˆØ§Ù„Ø®Ø§Ø±Ø¬ Ø¹Ù† Ø§Ù„Ù…Ø£Ù„ÙˆÙ',
                        xp: 500
                    },
                    
                    // Ù…Ù‡Ø§Ø±Ø§Øª Ø®Ø¨ÙŠØ±
                    'Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…ØªÙ‚Ø¯Ù…': {
                        level: 5,
                        requirements: ['Ø¥Ø¨Ø¯Ø§Ø¹ ÙˆØªÙÙƒÙŠØ± Ø¬Ø§Ù†Ø¨ÙŠ', 'ØªØ­Ù„ÙŠÙ„ Ø³ÙŠØ§Ù‚ÙŠ'],
                        unlocks: ['ØªØ·ÙˆÙŠØ± Ø§Ù„Ø°Ø§Øª', 'ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†'],
                        description: 'Ø¥ØªÙ‚Ø§Ù† ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©',
                        xp: 1000
                    }
                };
                
                Object.entries(skills).forEach(([skill, data]) => {
                    this.skillTree.set(skill, data);
                });
            }
            
            async createLearningPaths() {
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø±Ø§Øª ØªØ¹Ù„Ù… Ù…Ø®ØµØµØ©
                this.learningPaths.set('Ù…Ø³Ø§Ø± Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø³Ø±ÙŠØ¹', [
                    'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ',
                    'Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª',
                    'ÙÙ‡Ù… Ø¹Ù…ÙŠÙ‚',
                    'Ø¥Ø¨Ø¯Ø§Ø¹ ÙˆØªÙÙƒÙŠØ± Ø¬Ø§Ù†Ø¨ÙŠ'
                ]);
                
                this.learningPaths.set('Ù…Ø³Ø§Ø± Ø§Ù„Ù…ØªØ®ØµØµ', [
                    'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ',
                    'ÙÙ‡Ù… Ø¹Ù…ÙŠÙ‚',
                    'ØªØ­Ù„ÙŠÙ„ Ø³ÙŠØ§Ù‚ÙŠ',
                    'Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…ØªÙ‚Ø¯Ù…'
                ]);
                
                this.learningPaths.set('Ù…Ø³Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ø¯', [
                    'Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª',
                    'ØªÙÙƒÙŠØ± Ù†Ù‚Ø¯ÙŠ',
                    'Ø¥Ø¨Ø¯Ø§Ø¹ ÙˆØªÙÙƒÙŠØ± Ø¬Ø§Ù†Ø¨ÙŠ',
                    'ØªØ·ÙˆÙŠØ± Ø§Ù„Ø°Ø§Øª'
                ]);
            }
            
            async loadAchievements() {
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
                const achievements = [
                    { id: 'first_test', name: 'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£ÙˆÙ„', description: 'Ø£ÙƒÙ…Ù„ Ø£ÙˆÙ„ Ø§Ø®ØªØ¨Ø§Ø±', icon: 'ğŸ†' },
                    { id: 'perfect_score', name: 'Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', description: 'Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ 100% ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø±', icon: 'â­' },
                    { id: 'fast_learner', name: 'Ù…ØªØ¹Ù„Ù… Ø³Ø±ÙŠØ¹', description: 'Ø£ÙƒÙ…Ù„ 10 Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙÙŠ Ø£Ø³Ø¨ÙˆØ¹', icon: 'âš¡' },
                    { id: 'knowledge_master', name: 'Ø³ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø±ÙØ©', description: 'Ø£ÙƒÙ…Ù„ 100 Ø³Ø¤Ø§Ù„', icon: 'ğŸ‘‘' },
                    { id: 'ai_expert', name: 'Ø®Ø¨ÙŠØ± Ø§Ù„Ø°ÙƒØ§Ø¡', description: 'Ø·ÙˆØ± Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', icon: 'ğŸ¤–' }
                ];
                
                achievements.forEach(achievement => {
                    this.achievements.add(achievement);
                });
            }
            
            async updateProgress(skill, xpGained) {
                // ØªØ­Ø¯ÙŠØ« ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                if (!this.progressTracking.has(skill)) {
                    this.progressTracking.set(skill, {
                        xp: 0,
                        level: 0,
                        lastUpdated: new Date().toISOString()
                    });
                }
                
                const progress = this.progressTracking.get(skill);
                progress.xp += xpGained;
                progress.lastUpdated = new Date().toISOString();
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯
                const newLevel = Math.floor(progress.xp / 100);
                if (newLevel > progress.level) {
                    progress.level = newLevel;
                    this.unlockAchievements(skill, newLevel);
                    this.checkSkillUnlocks(skill);
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                this.updateUserProfile(skill, progress);
            }
            
            unlockAchievements(skill, level) {
                // ÙØªØ­ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                if (level >= 5) {
                    this.awardAchievement('ai_expert');
                }
                
                if (skill === 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ' && level >= 3) {
                    this.awardAchievement('knowledge_master');
                }
            }
            
            awardAchievement(achievementId) {
                // Ù…Ù†Ø­ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                const achievement = Array.from(this.achievements).find(a => a.id === achievementId);
                if (achievement && !userData.achievements?.includes(achievementId)) {
                    userData.achievements = userData.achievements || [];
                    userData.achievements.push(achievementId);
                    
                    // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
                    showNotification(`ğŸ‰ Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø¥Ù†Ø¬Ø§Ø²: ${achievement.name}`);
                    
                    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    saveUserData();
                }
            }
            
            checkSkillUnlocks(currentSkill) {
                // ÙØ­Øµ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„ØªÙŠ ØªÙ… ÙØªØ­Ù‡Ø§
                const skillData = this.skillTree.get(currentSkill);
                if (skillData?.unlocks) {
                    skillData.unlocks.forEach(newSkill => {
                        if (!userData.unlockedSkills?.includes(newSkill)) {
                            userData.unlockedSkills = userData.unlockedSkills || [];
                            userData.unlockedSkills.push(newSkill);
                            
                            showNotification(`ğŸ”“ ÙØªØ­Øª Ù…Ù‡Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©: ${newSkill}`);
                        }
                    });
                }
            }
            
            updateUserProfile(skill, progress) {
                // ØªØ­Ø¯ÙŠØ« Ù…Ù„Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                if (!userData.skillsProgress) {
                    userData.skillsProgress = {};
                }
                
                userData.skillsProgress[skill] = {
                    xp: progress.xp,
                    level: progress.level,
                    lastUpdated: progress.lastUpdated
                };
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¹Ø§Ù…
                this.calculateOverallLevel();
            }
            
            calculateOverallLevel() {
                let totalXP = 0;
                let totalLevels = 0;
                
                Object.values(userData.skillsProgress || {}).forEach(progress => {
                    totalXP += progress.xp;
                    totalLevels += progress.level;
                });
                
                const skillCount = Object.keys(userData.skillsProgress || {}).length;
                userData.overallLevel = skillCount > 0 ? Math.floor(totalLevels / skillCount) : 1;
                userData.totalXP = totalXP;
            }
            
            async recommendLearningPath() {
                // Ø§Ù„ØªÙˆØµÙŠØ© Ø¨Ù…Ø³Ø§Ø± ØªØ¹Ù„Ù… Ù…Ø®ØµØµ
                const userSkills = userData.skillsProgress || {};
                const weakAreas = this.identifyWeakAreas(userSkills);
                
                let recommendedPath = 'Ù…Ø³Ø§Ø± Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø³Ø±ÙŠØ¹';
                
                if (weakAreas.includes('ØªØ­Ù„ÙŠÙ„')) {
                    recommendedPath = 'Ù…Ø³Ø§Ø± Ø§Ù„Ù…ØªØ®ØµØµ';
                } else if (weakAreas.includes('Ø¥Ø¨Ø¯Ø§Ø¹')) {
                    recommendedPath = 'Ù…Ø³Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ø¯';
                }
                
                return {
                    path: recommendedPath,
                    skills: this.learningPaths.get(recommendedPath),
                    estimatedTime: '4 Ø£Ø³Ø§Ø¨ÙŠØ¹',
                    difficulty: 'Ù…ØªÙˆØ³Ø·'
                };
            }
            
            identifyWeakAreas(skills) {
                const weakAreas = [];
                Object.entries(skills).forEach(([skill, progress]) => {
                    if (progress.level < 2) {
                        weakAreas.push(skill);
                    }
                });
                return weakAreas;
            }
        }

        // =============== [ 6. Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„ØªØ·ÙˆØ±ÙŠ ] ===============
        class EvolutionaryAI {
            constructor() {
                this.population = [];
                this.generation = 0;
                this.mutationRate = 0.01;
                this.crossoverRate = 0.7;
                this.elitism = 2;
                this.bestSolution = null;
            }
            
            async evolve(generations = 100) {
                console.log('ğŸ§¬ Ø¨Ø¯Ø£ Ø§Ù„ØªØ·ÙˆØ± Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ...');
                
                // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„
                await this.initializePopulation();
                
                for (let gen = 0; gen < generations; gen++) {
                    this.generation = gen;
                    
                    // ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù„ÙŠØ§Ù‚Ø©
                    await this.evaluateFitness();
                    
                    // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£ÙØ¶Ù„
                    this.selection();
                    
                    // Ø§Ù„ØªÙƒØ§Ø«Ø± (Ø¹Ø¨ÙˆØ± ÙˆØ·ÙØ±Ø©)
                    this.reproduction();
                    
                    // Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙØ¶Ù„ (Ø§Ù„Ù†Ø®Ø¨Ø©)
                    this.applyElitism();
                    
                    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªÙ‚Ø¯Ù…
                    this.logProgress();
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                    updateEvolutionProgress(gen, generations);
                }
                
                console.log('âœ… Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªØ·ÙˆØ± Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ');
                return this.bestSolution;
            }
            
            async initializePopulation() {
                this.population = [];
                for (let i = 0; i < 50; i++) {
                    this.population.push(this.createRandomSolution());
                }
            }
            
            createRandomSolution() {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ù„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
                return {
                    genes: Array(100).fill(0).map(() => Math.random()),
                    fitness: 0,
                    skills: this.generateRandomSkills()
                };
            }
            
            async evaluateFitness() {
                // ØªÙ‚ÙŠÙŠÙ… Ù…Ù„Ø§Ø¡Ù…Ø© ÙƒÙ„ Ø­Ù„
                for (let solution of this.population) {
                    solution.fitness = await this.calculateFitness(solution);
                }
                
                // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ù„ÙŠØ§Ù‚Ø©
                this.population.sort((a, b) => b.fitness - a.fitness);
                
                // ØªØ­Ø¯ÙŠØ« Ø£ÙØ¶Ù„ Ø­Ù„
                if (!this.bestSolution || this.population[0].fitness > this.bestSolution.fitness) {
                    this.bestSolution = { ...this.population[0] };
                }
            }
            
            async calculateFitness(solution) {
                // Ø­Ø³Ø§Ø¨ Ø¯Ø±Ø¬Ø© Ø§Ù„Ù„ÙŠØ§Ù‚Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¹Ø¯Ø© Ø¹ÙˆØ§Ù…Ù„
                const factors = {
                    intelligence: this.calculateIntelligenceScore(solution),
                    creativity: this.calculateCreativityScore(solution),
                    adaptability: this.calculateAdaptabilityScore(solution),
                    efficiency: this.calculateEfficiencyScore(solution)
                };
                
                return Object.values(factors).reduce((a, b) => a + b, 0) / Object.keys(factors).length;
            }
            
            selection() {
                // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø£ÙØ¶Ù„ Ù„Ù„ØªÙƒØ§Ø«Ø±
                const selected = [];
                const populationSize = this.population.length;
                
                for (let i = 0; i < populationSize; i++) {
                    // Ø§Ø®ØªÙŠØ§Ø± ÙØ±Ø¯ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù…Ø¹ ØªÙØ¶ÙŠÙ„ Ø§Ù„Ø£ÙØ¶Ù„
                    const index = Math.floor(Math.pow(Math.random(), 2) * populationSize);
                    selected.push(this.population[index]);
                }
                
                this.population = selected;
            }
            
            reproduction() {
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ø¨ÙˆØ± ÙˆØ§Ù„Ø·ÙØ±Ø©
                const newPopulation = [];
                
                for (let i = 0; i < this.population.length; i += 2) {
                    if (i + 1 < this.population.length) {
                        const parent1 = this.population[i];
                        const parent2 = this.population[i + 1];
                        
                        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ø¨ÙˆØ±
                        const [child1, child2] = this.crossover(parent1, parent2);
                        
                        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø·ÙØ±Ø©
                        this.mutate(child1);
                        this.mutate(child2);
                        
                        newPopulation.push(child1, child2);
                    }
                }
                
                this.population = newPopulation;
            }
            
            crossover(parent1, parent2) {
                if (Math.random() > this.crossoverRate) {
                    return [parent1, parent2];
                }
                
                const crossoverPoint = Math.floor(Math.random() * parent1.genes.length);
                
                const child1 = {
                    genes: [...parent1.genes.slice(0, crossoverPoint), ...parent2.genes.slice(crossoverPoint)],
                    fitness: 0,
                    skills: this.combineSkills(parent1.skills, parent2.skills)
                };
                
                const child2 = {
                    genes: [...parent2.genes.slice(0, crossoverPoint), ...parent1.genes.slice(crossoverPoint)],
                    fitness: 0,
                    skills: this.combineSkills(parent2.skills, parent1.skills)
                };
                
                return [child1, child2];
            }
            
            mutate(solution) {
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø·ÙØ±Ø§Øª Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
                for (let i = 0; i < solution.genes.length; i++) {
                    if (Math.random() < this.mutationRate) {
                        solution.genes[i] = Math.random();
                    }
                }
                
                // Ø·ÙØ±Ø§Øª ÙÙŠ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª
                if (Math.random() < this.mutationRate * 10) {
                    solution.skills = this.mutateSkills(solution.skills);
                }
            }
            
            applyElitism() {
                // Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ø§Ù„Ø£ÙØ±Ø§Ø¯
                if (this.bestSolution) {
                    this.population[0] = { ...this.bestSolution };
                    if (this.elitism > 1 && this.population[1]) {
                        this.population[1] = { ...this.population[1] };
                    }
                }
            }
            
            logProgress() {
                console.log(`ğŸ§¬ Ø§Ù„Ø¬ÙŠÙ„ ${this.generation}: Ø£ÙØ¶Ù„ Ù„ÙŠØ§Ù‚Ø© = ${this.bestSolution?.fitness?.toFixed(3)}`);
            }
            
            // ========== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ==========
            
            generateRandomSkills() {
                const allSkills = ['ØªØ­Ù„ÙŠÙ„', 'Ø¥Ø¨Ø¯Ø§Ø¹', 'Ù…Ù†Ø·Ù‚', 'Ø°Ø§ÙƒØ±Ø©', 'Ø³Ø±Ø¹Ø©', 'Ø¯Ù‚Ø©'];
                const skills = {};
                
                allSkills.forEach(skill => {
                    skills[skill] = Math.random();
                });
                
                return skills;
            }
            
            combineSkills(skills1, skills2) {
                const combined = {};
                Object.keys(skills1).forEach(skill => {
                    combined[skill] = (skills1[skill] + skills2[skill]) / 2;
                });
                return combined;
            }
            
            mutateSkills(skills) {
                const mutated = { ...skills };
                const skillToMutate = Object.keys(skills)[Math.floor(Math.random() * Object.keys(skills).length)];
                mutated[skillToMutate] = Math.random();
                return mutated;
            }
            
            calculateIntelligenceScore(solution) {
                // Ø­Ø³Ø§Ø¨ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø°ÙƒØ§Ø¡
                return solution.genes.reduce((a, b) => a + b, 0) / solution.genes.length;
            }
            
            calculateCreativityScore(solution) {
                // Ø­Ø³Ø§Ø¨ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹
                const variance = this.calculateVariance(solution.genes);
                return Math.min(variance * 10, 1);
            }
            
            calculateVariance(array) {
                const mean = array.reduce((a, b) => a + b, 0) / array.length;
                return array.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / array.length;
            }
            
            calculateAdaptabilityScore(solution) {
                // Ø­Ø³Ø§Ø¨ Ø¯Ø±Ø¬Ø© Ø§Ù„ØªÙƒÙŠÙ
                return Math.abs(0.5 - solution.genes[0]) * 2;
            }
            
            calculateEfficiencyScore(solution) {
                // Ø­Ø³Ø§Ø¨ Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙØ§Ø¡Ø©
                return 1 - Math.abs(0.7 - solution.genes.reduce((a, b) => a + b, 0) / solution.genes.length);
            }
        }

        // =============== [ 7. Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ] ===============
        class UserManager {
            constructor() {
                this.users = new Map();
                this.sessions = new Map();
            }
            
            async register(email, password, userData) {
                try {
                    const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                    const user = userCredential.user;
                    
                    // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    await db.ref(`users/${user.uid}`).set({
                        email: email,
                        ...userData,
                        createdAt: new Date().toISOString(),
                        lastLogin: new Date().toISOString(),
                        stats: {
                            testsTaken: 0,
                            averageScore: 0,
                            totalXP: 0,
                            level: 1,
                            streak: 0
                        },
                        preferences: {
                            theme: 'dark',
                            language: 'ar',
                            notifications: true
                        }
                    });
                    
                    // Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø§Ù„ØªØ­Ù‚Ù‚
                    await user.sendEmailVerification();
                    
                    return { success: true, user };
                } catch (error) {
                    return { success: false, error: error.message };
                }
            }
            
            async login(email, password) {
                try {
                    const userCredential = await auth.signInWithEmailAndPassword(email, password);
                    const user = userCredential.user;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± Ø¯Ø®ÙˆÙ„
                    await db.ref(`users/${user.uid}/lastLogin`).set(new Date().toISOString());
                    
                    // Ø²ÙŠØ§Ø¯Ø© streak
                    await this.updateStreak(user.uid);
                    
                    return { success: true, user };
                } catch (error) {
                    return { success: false, error: error.message };
                }
            }
            
            async updateStreak(userId) {
                const userRef = db.ref(`users/${userId}/stats`);
                const snapshot = await userRef.once('value');
                const stats = snapshot.val() || {};
                
                const today = new Date().toDateString();
                const lastLogin = stats.lastLoginDate ? new Date(stats.lastLoginDate).toDateString() : null;
                
                if (lastLogin === today) {
                    // Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ…
                    return;
                } else if (lastLogin && isYesterday(lastLogin, today)) {
                    // ÙŠÙˆÙ… Ù…ØªØªØ§Ù„ÙŠ
                    stats.streak = (stats.streak || 0) + 1;
                } else {
                    // ÙƒØ³Ø± Ø§Ù„ØªØªØ§Ø¨Ø¹
                    stats.streak = 1;
                }
                
                stats.lastLoginDate = new Date().toISOString();
                await userRef.update(stats);
            }
            
            async loadUserData(userId) {
                try {
                    const snapshot = await db.ref(`users/${userId}`).once('value');
                    return snapshot.val();
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', error);
                    return null;
                }
            }
            
            async saveUserData(userId, data) {
                try {
                    await db.ref(`users/${userId}`).update(data);
                    return true;
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', error);
                    return false;
                }
            }
            
            async uploadProfileImage(userId, imageFile) {
                try {
                    const storageRef = storage.ref(`profile-images/${userId}`);
                    const snapshot = await storageRef.put(imageFile);
                    const downloadURL = await snapshot.ref.getDownloadURL();
                    
                    await db.ref(`users/${userId}/profileImage`).set(downloadURL);
                    return downloadURL;
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©:', error);
                    return null;
                }
            }
        }

        // =============== [ 8. Ø¯ÙˆØ§Ù„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ] ===============
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª
        let testSystem = new TestSystem();
        let improvementSystem = new SelfImprovementSystem();
        let evolutionaryAI = new EvolutionaryAI();
        let userManager = new UserManager();
        
        async function loadComponents() {
            await improvementSystem.initialize();
            await testSystem.initialize();
        }
        
        function showLoginScreen() {
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('app-screen').classList.add('hidden');
        }
        
        function showAppScreen() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('app-screen').classList.remove('hidden');
            openModule('dashboard');
        }
        
        function openModule(moduleName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª
            document.querySelectorAll('.module').forEach(module => {
                module.classList.remove('active');
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            const module = document.getElementById(`${moduleName}-module`);
            if (module) {
                module.classList.add('active');
                loadModuleContent(moduleName);
            }
        }
        
        function closeModule() {
            document.querySelectorAll('.module').forEach(module => {
                module.classList.remove('active');
            });
            openModule('dashboard');
        }
        
        async function loadModuleContent(moduleName) {
            const contentArea = document.getElementById('content-area');
            contentArea.innerHTML = '';
            
            switch(moduleName) {
                case 'dashboard':
                    await loadDashboard();
                    break;
                case 'test-generator':
                    await loadTestGenerator();
                    break;
                case 'test-history':
                    await loadTestHistory();
                    break;
                case 'skill-tree':
                    await loadSkillTree();
                    break;
                case 'achievements':
                    await loadAchievements();
                    break;
                case 'simulation':
                    await loadSimulation();
                    break;
                case 'ai-training':
                    await loadAITraining();
                    break;
                case 'progress':
                    await loadProgress();
                    break;
            }
        }
        
        // ========== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ==========
        
        async function loadDashboard() {
            const content = `
                <div style="max-width: 1200px; margin: 0 auto;">
                    <h1 style="color: var(--neon-blue); margin-bottom: 30px;">Ù…Ø±Ø­Ø¨Ø§Ù‹ ${userData.name || 'Ù…Ø³ØªØ®Ø¯Ù…'}! ğŸ‘‹</h1>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div style="background: var(--gradient-card); padding: 20px; border-radius: 15px; border: 2px solid rgba(0,245,255,0.2);">
                            <h3 style="color: var(--neon-blue);"><i class="fas fa-chart-line"></i> ØªÙ‚Ø¯Ù…Ùƒ</h3>
                            <div style="font-size: 36px; color: var(--neon-green);">${userData.stats?.level || 1}</div>
                            <div style="color: var(--text-secondary);">Ø§Ù„Ù…Ø³ØªÙˆÙ‰</div>
                        </div>
                        
                        <div style="background: var(--gradient-card); padding: 20px; border-radius: 15px; border: 2px solid rgba(157,78,221,0.2);">
                            <h3 style="color: var(--neon-purple);"><i class="fas fa-tasks"></i> Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h3>
                            <div style="font-size: 36px; color: var(--neon-purple);">${userData.stats?.testsTaken || 0}</div>
                            <div style="color: var(--text-secondary);">Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙƒØªÙ…Ù„</div>
                        </div>
                        
                        <div style="background: var(--gradient-card); padding: 20px; border-radius: 15px; border: 2px solid rgba(0,255,157,0.2);">
                            <h3 style="color: var(--neon-green);"><i class="fas fa-fire"></i> Ø§Ù„ØªØªØ§Ø¨Ø¹</h3>
                            <div style="font-size: 36px; color: var(--neon-green);">${userData.stats?.streak || 0}</div>
                            <div style="color: var(--text-secondary);">ÙŠÙˆÙ… Ù…ØªØªØ§Ù„ÙŠ</div>
                        </div>
                    </div>
                    
                    <div style="background: var(--gradient-card); padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 2px solid rgba(0,245,255,0.2);">
                        <h3 style="color: var(--neon-blue); margin-bottom: 20px;"><i class="fas fa-bullseye"></i> Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ÙŠÙˆÙ…</h3>
                        <div id="daily-goals-list"></div>
                    </div>
                    
                    <div style="background: var(--gradient-card); padding: 25px; border-radius: 15px; border: 2px solid rgba(157,78,221,0.2);">
                        <h3 style="color: var(--neon-purple); margin-bottom: 20px;"><i class="fas fa-bolt"></i> Ø£Ù†Ø´Ø¦ Ø§Ø®ØªØ¨Ø§Ø±Ø§Ù‹ Ø¬Ø¯ÙŠØ¯Ø§Ù‹</h3>
                        <button class="btn btn-primary" onclick="openModule('test-generator')" style="width: 100%; padding: 15px;">
                            <i class="fas fa-plus-circle"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø°ÙƒÙŠ
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('content-area').innerHTML = content;
            updateDailyGoals();
        }
        
        async function loadTestGenerator() {
            const content = `
                <div style="max-width: 800px; margin: 0 auto;">
                    <h1 style="color: var(--neon-blue); margin-bottom: 30px;"><i class="fas fa-magic"></i> Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒÙŠ</h1>
                    
                    <div style="background: var(--gradient-card); padding: 25px; border-radius: 15px; border: 2px solid rgba(0,245,255,0.2);">
                        <h3 style="color: var(--neon-blue); margin-bottom: 20px;">Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:</h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div class="action-btn" onclick="switchTestTab('text')">
                                <i class="fas fa-font" style="font-size: 30px; color: var(--neon-blue);"></i>
                                <h4>Ù…Ù† Ù†Øµ</h4>
                                <p>Ø£Ø¯Ø®Ù„ Ø£Ùˆ Ø§Ù„ØµÙ‚ Ø§Ù„Ù†Øµ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ</p>
                            </div>
                            
                            <div class="action-btn" onclick="switchTestTab('image')">
                                <i class="fas fa-image" style="font-size: 30px; color: var(--neon-green);"></i>
                                <h4>Ù…Ù† ØµÙˆØ±Ø©</h4>
                                <p>Ø±ÙØ¹ ØµÙˆØ±Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù†Øµ</p>
                            </div>
                            
                            <div class="action-btn" onclick="switchTestTab('topic')">
                                <i class="fas fa-hashtag" style="font-size: 30px; color: var(--neon-purple);"></i>
                                <h4>Ø¹Ù†ÙˆØ§Ù† Ø±Ø¦ÙŠØ³ÙŠ</h4>
                                <p>Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù†Ø§Ù‹ Ù„Ù…ÙˆØ¶ÙˆØ¹ Ù…Ø¹ÙŠÙ†</p>
                            </div>
                        </div>
                        
                        <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
                        <div id="tab-content-area"></div>
                    </div>
                </div>
            `;
            
            document.getElementById('content-area').innerHTML = content;
            switchTestTab('text');
        }
        
        function switchTestTab(tabName) {
            const tabContent = document.getElementById('tab-content-area');
            let content = '';
            
            switch(tabName) {
                case 'text':
                    content = `
                        <div>
                            <h4 style="color: var(--neon-blue); margin-bottom: 15px;"><i class="fas fa-font"></i> Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ</h4>
                            <textarea id="input-text" class="form-control text-area" placeholder="Ø§Ù„ØµÙ‚ Ø§Ù„Ù†Øµ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ù‡Ù†Ø§..."></textarea>
                            
                            <div style="margin-top: 20px;">
                                <h5 style="color: var(--text-secondary); margin-bottom: 10px;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h5>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div>
                                        <label style="color: var(--text-secondary); display: block; margin-bottom: 5px;">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</label>
                                        <input type="number" id="question-count" class="form-control" min="5" max="50" value="20">
                                    </div>
                                    
                                    <div>
                                        <label style="color: var(--text-secondary); display: block; margin-bottom: 5px;">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©</label>
                                        <select id="difficulty" class="form-control">
                                            <option value="easy">Ø³Ù‡Ù„</option>
                                            <option value="medium" selected>Ù…ØªÙˆØ³Ø·</option>
                                            <option value="hard">ØµØ¹Ø¨</option>
                                            <option value="expert">Ø®Ø¨ÙŠØ±</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="btn btn-primary" onclick="generateTest()" style="width: 100%; margin-top: 30px; padding: 15px;">
                                <i class="fas fa-magic"></i> ØªÙˆÙ„ÙŠØ¯ Ø§Ø®ØªØ¨Ø§Ø± Ø°ÙƒÙŠ
                            </button>
                        </div>
                    `;
                    break;
                    
                case 'image':
                    content = `
                        <div>
                            <h4 style="color: var(--neon-green); margin-bottom: 15px;"><i class="fas fa-image"></i> Ø±ÙØ¹ ØµÙˆØ±Ø©</h4>
                            
                            <div style="border: 2px dashed rgba(0,245,255,0.3); border-radius: 10px; padding: 40px; text-align: center; margin-bottom: 20px;">
                                <i class="fas fa-cloud-upload-alt" style="font-size: 48px; color: var(--neon-blue); margin-bottom: 15px;"></i>
                                <p style="color: var(--text-secondary); margin-bottom: 15px;">Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ø§Ù„ØµÙˆØ±Ø© Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</p>
                                <input type="file" id="image-input" accept="image/*" style="display: none;">
                                <button class="btn btn-secondary" onclick="document.getElementById('image-input').click()">
                                    <i class="fas fa-folder-open"></i> Ø§Ø®ØªØ± ØµÙˆØ±Ø©
                                </button>
                            </div>
                            
                            <div id="image-preview-area" style="display: none;">
                                <h5 style="color: var(--text-secondary); margin-bottom: 10px;">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©:</h5>
                                <img id="preview-image" style="max-width: 100%; max-height: 300px; border-radius: 10px;">
                            </div>
                            
                            <button id="generate-from-image" class="btn btn-primary" onclick="generateTestFromImage()" style="width: 100%; margin-top: 30px; padding: 15px;" disabled>
                                <i class="fas fa-image"></i> Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø±
                            </button>
                        </div>
                    `;
                    
                    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø­Ø¯Ø« Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙˆØ±Ø©
                    setTimeout(() => {
                        const imageInput = document.getElementById('image-input');
                        if (imageInput) {
                            imageInput.addEventListener('change', handleImageUpload);
                        }
                    }, 100);
                    break;
                    
                case 'topic':
                    content = `
                        <div>
                            <h4 style="color: var(--neon-purple); margin-bottom: 15px;"><i class="fas fa-hashtag"></i> Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</h4>
                            <input type="text" id="topic-input" class="form-control" placeholder="Ù…Ø«Ø§Ù„: Ù†Ø¸Ø±ÙŠØ© Ø§Ù„ØªØ·ÙˆØ± ÙÙŠ Ø¹Ù„Ù… Ø§Ù„Ø£Ø­ÙŠØ§Ø¡">
                            
                            <div style="margin-top: 20px;">
                                <h5 style="color: var(--text-secondary); margin-bottom: 10px;">Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©:</h5>
                                <textarea id="topic-details" class="form-control" placeholder="ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù† Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" rows="3"></textarea>
                            </div>
                            
                            <button class="btn btn-primary" onclick="generateTestFromTopic()" style="width: 100%; margin-top: 30px; padding: 15px;">
                                <i class="fas fa-brain"></i> ØªÙˆÙ„ÙŠØ¯ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
                            </button>
                        </div>
                    `;
                    break;
            }
            
            tabContent.innerHTML = content;
        }
        
        // ========== Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… ==========
        
        async function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            if (!email || !password) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±', 'error');
                return;
            }
            
            showLoading('Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...');
            
            const result = await userManager.login(email, password);
            
            hideLoading();
            
            if (result.success) {
                showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø®Ø§Ø±Ù‚!', 'success');
            } else {
                showNotification(result.error, 'error');
            }
        }
        
        async function logout() {
            await auth.signOut();
            showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'success');
            showLoginScreen();
        }
        
        async function loadUserData() {
            if (!currentUser) return;
            
            userData = await userManager.loadUserData(currentUser.uid) || {};
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.getElementById('user-name').textContent = userData.name || 'Ù…Ø³ØªØ®Ø¯Ù…';
            document.getElementById('user-level').textContent = `Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${userData.stats?.level || 1}`;
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø°ÙƒØ§Ø¡
            updateAIStatus();
        }
        
        async function saveUserData() {
            if (!currentUser || !userData) return;
            
            await userManager.saveUserData(currentUser.uid, userData);
        }
        
        async function generateTest() {
            const text = document.getElementById('input-text')?.value;
            const questionCount = parseInt(document.getElementById('question-count')?.value) || 20;
            const difficulty = document.getElementById('difficulty')?.value || 'medium';
            
            if (!text || text.length < 100) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ ÙŠØªÙƒÙˆÙ† Ù…Ù† 100 Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
                return;
            }
            
            showLoading('Ø¬Ø§Ø±ÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ø®ØªØ¨Ø§Ø± Ø°ÙƒÙŠ...');
            
            try {
                const test = await testSystem.generateTestFromText(text, {
                    count: questionCount,
                    difficulty: difficulty
                });
                
                hideLoading();
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                displayTest(test);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                userData.stats = userData.stats || {};
                userData.stats.testsGenerated = (userData.stats.testsGenerated || 0) + 1;
                await saveUserData();
                
                showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                
            } catch (error) {
                hideLoading();
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'error');
                console.error(error);
            }
        }
        
        async function generateTestFromImage() {
            const imageInput = document.getElementById('image-input');
            if (!imageInput?.files[0]) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            showLoading('Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø±...');
            
            try {
                const test = await testSystem.generateTestFromImage(imageInput.files[0], {
                    count: 20,
                    difficulty: 'medium'
                });
                
                hideLoading();
                displayTest(test);
                showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                
            } catch (error) {
                hideLoading();
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±Ø©', 'error');
                console.error(error);
            }
        }
        
        function displayTest(test) {
            const content = `
                <div style="max-width: 800px; margin: 0 auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <h2 style="color: var(--neon-blue);">${test.title}</h2>
                        <button class="btn btn-secondary" onclick="openModule('test-generator')">
                            <i class="fas fa-arrow-right"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                    
                    <div style="background: var(--gradient-card); padding: 25px; border-radius: 15px; border: 2px solid rgba(0,245,255,0.2); margin-bottom: 30px;">
                        <h4 style="color: var(--neon-blue); margin-bottom: 15px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div>
                                <div style="color: var(--text-secondary);">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</div>
                                <div style="color: var(--neon-blue); font-size: 24px;">${test.questions.length}</div>
                            </div>
                            <div>
                                <div style="color: var(--text-secondary);">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©</div>
                                <div style="color: var(--neon-green); font-size: 24px;">${test.settings.difficulty}</div>
                            </div>
                            <div>
                                <div style="color: var(--text-secondary);">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚Ø¯Ø±</div>
                                <div style="color: var(--neon-purple); font-size: 24px;">${test.settings.timeLimit} Ø¯Ù‚ÙŠÙ‚Ø©</div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="test-questions-area"></div>
                    
                    <button class="btn btn-primary" onclick="startTest()" style="width: 100%; padding: 15px; margin-top: 30px;">
                        <i class="fas fa-play"></i> Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                    </button>
                </div>
            `;
            
            document.getElementById('content-area').innerHTML = content;
            displayQuestions(test.questions);
        }
        
        function displayQuestions(questions) {
            const container = document.getElementById('test-questions-area');
            let html = '<h3 style="color: var(--neon-blue); margin-bottom: 20px;">Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h3>';
            
            questions.forEach((question, index) => {
                html += `
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin-bottom: 15px; border: 1px solid rgba(0,245,255,0.1);">
                        <div style="color: var(--neon-blue); margin-bottom: 10px;">Ø§Ù„Ø³Ø¤Ø§Ù„ ${index + 1}:</div>
                        <div style="color: white; margin-bottom: 15px;">${question.text}</div>
                        
                        ${question.options ? `
                            <div style="margin-top: 10px;">
                                ${question.options.map((option, optIndex) => `
                                    <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 8px; margin-bottom: 5px; border: 1px solid rgba(255,255,255,0.1);">
                                        ${optIndex + 1}. ${option}
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        async function startTest() {
            showNotification('Ø³ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ø±ÙŠØ¨Ø§Ù‹...', 'info');
            // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ
        }
        
        async function runAISimulation() {
            const processDiv = document.getElementById('thinking-process');
            processDiv.innerHTML = '<div style="color: var(--text-secondary);"><i class="fas fa-cog fa-spin"></i> Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©...</div>';
            
            // Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªÙÙƒÙŠØ±
            const processes = [
                'ğŸ§  ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©...',
                'ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ù†Ù…Ø§Ø· Ù…Ø¹Ø±ÙÙŠØ©...',
                'âš¡ ØªØ·Ø¨ÙŠÙ‚ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª Ø§Ù„ØªØ¹Ù„Ù…...',
                'ğŸ’¡ ØªÙˆÙ„ÙŠØ¯ Ø£ÙÙƒØ§Ø± Ø¬Ø¯ÙŠØ¯Ø©...',
                'ğŸ“Š ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†ØªØ§Ø¦Ø¬...',
                'ğŸš€ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø¹Ø±ÙÙŠ...'
            ];
            
            let index = 0;
            const interval = setInterval(() => {
                if (index < processes.length) {
                    processDiv.innerHTML += `<div style="margin-top: 10px; color: var(--neon-blue);">${processes[index]}</div>`;
                    processDiv.scrollTop = processDiv.scrollHeight;
                    index++;
                } else {
                    clearInterval(interval);
                    processDiv.innerHTML += '<div style="margin-top: 20px; color: var(--neon-green);"><i class="fas fa-check"></i> Ø§ÙƒØªÙ…Ù„Øª Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø¨Ù†Ø¬Ø§Ø­!</div>';
                    
                    // ØªØ­Ø¯ÙŠØ« Ø£Ø´Ø±Ø·Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
                    updateProgressBars();
                }
            }, 1000);
        }
        
        function updateProgressBars() {
            // ØªØ­Ø¯ÙŠØ« Ø£Ø´Ø±Ø·Ø© Ø§Ù„ØªÙ‚Ø¯Ù… Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
            const bars = ['perception-bar', 'learning-bar', 'logic-bar', 'creativity-bar'];
            bars.forEach(barId => {
                const bar = document.getElementById(barId);
                const newWidth = Math.min(100, Math.random() * 100);
                bar.style.width = `${newWidth}%`;
            });
        }
        
        async function startAITraining() {
            const type = document.getElementById('training-type').value;
            const level = document.getElementById('training-level').value;
            const rounds = parseInt(document.getElementById('training-rounds').value);
            
            if (trainingActive) {
                showNotification('Ø¬Ø§Ø±ÙŠØ© Ø¹Ù…Ù„ÙŠØ© ØªØ¯Ø±ÙŠØ¨ Ø£Ø®Ø±Ù‰', 'warning');
                return;
            }
            
            trainingActive = true;
            const logDiv = document.getElementById('training-log');
            logDiv.innerHTML = '';
            
            showLoading(`Ø¨Ø¯Ø¡ ØªØ¯Ø±ÙŠØ¨ ${type}...`);
            
            try {
                for (let i = 0; i < rounds; i++) {
                    // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨
                    const progress = ((i + 1) / rounds) * 100;
                    document.getElementById('training-progress').textContent = `${Math.round(progress)}%`;
                    document.querySelector('.circular-progress-fill').style.strokeDashoffset = 282.6 - (282.6 * progress / 100);
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ø±ÙŠØ¨
                    const logEntry = `Ø§Ù„Ø¬ÙˆÙ„Ø© ${i + 1}: ØªØ­Ø³Ù† ÙÙŠ ${type} Ø¨Ù†Ø³Ø¨Ø© ${(Math.random() * 5).toFixed(2)}%`;
                    logDiv.innerHTML += `<div style="color: var(--text-secondary); font-size: 12px; margin-bottom: 5px;">${logEntry}</div>`;
                    logDiv.scrollTop = logDiv.scrollHeight;
                    
                    await sleep(50); // ØªØ£Ø®ÙŠØ± Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨
                }
                
                hideLoading();
                showNotification('Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                
            } catch (error) {
                hideLoading();
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ¯Ø±ÙŠØ¨', 'error');
                console.error(error);
            }
            
            trainingActive = false;
        }
        
        // ========== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ==========
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = 'notification';
            
            let icon = 'â„¹ï¸';
            if (type === 'success') icon = 'âœ…';
            if (type === 'error') icon = 'âŒ';
            if (type === 'warning') icon = 'âš ï¸';
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span>${icon}</span>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }
        
        function showLoading(message) {
            // ØªÙ†ÙÙŠØ° SweetAlert2 Ù„Ù„ØªØ­Ù…ÙŠÙ„
            Swal.fire({
                title: message,
                allowOutsideClick: false,
                showConfirmButton: false,
                didOpen: () => Swal.showLoading()
            });
        }
        
        function hideLoading() {
            Swal.close();
        }
        
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.width = `${Math.random() * 5 + 2}px`;
                particle.style.height = particle.style.width;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.animationDelay = `${Math.random() * 15}s`;
                particle.style.animationDuration = `${Math.random() * 10 + 15}s`;
                particle.style.background = Math.random() > 0.5 ? 'var(--neon-blue)' : 'var(--neon-purple)';
                container.appendChild(particle);
            }
        }
        
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === 'n') {
                    e.preventDefault();
                    openModule('test-generator');
                }
                if (e.ctrlKey && e.key === 'd') {
                    e.preventDefault();
                    openModule('dashboard');
                }
                if (e.ctrlKey && e.key === 'q') {
                    e.preventDefault();
                    logout();
                }
            });
        }
        
        function updateDailyGoals() {
            const goals = [
                'Ø£ÙƒÙ…Ù„ Ø§Ø®ØªØ¨Ø§Ø±Ø§Ù‹ ÙˆØ§Ø­Ø¯Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„',
                'Ø§Ø±ÙØ¹ Ù…Ø³ØªÙˆÙ‰ Ù…Ù‡Ø§Ø±Ø© ÙˆØ§Ø­Ø¯Ø©',
                'Ø§Ù†Ø¸Ø± Ø¥Ù„Ù‰ Ø´Ø¬Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª',
                'Ø¬Ø±Ù‘Ø¨ Ù…ÙŠØ²Ø© Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø°ÙƒØ§Ø¡'
            ];
            
            const container = document.getElementById('daily-goals-list');
            container.innerHTML = goals.map(goal => `
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <input type="checkbox" style="transform: scale(1.2);">
                    <span style="color: var(--text-secondary);">${goal}</span>
                </div>
            `).join('');
        }
        
        function updateAIStatus() {
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
            const intelligence = 180 + (userData.stats?.level || 0) * 5;
            const knowledge = 1.2 + (userData.stats?.testsTaken || 0) * 0.01;
            
            document.getElementById('ai-intelligence').textContent = `IQ: ${intelligence}`;
            document.getElementById('ai-knowledge').textContent = `${knowledge.toFixed(1)}TB`;
        }
        
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const previewArea = document.getElementById('image-preview-area');
            const previewImage = document.getElementById('preview-image');
            const generateBtn = document.getElementById('generate-from-image');
            
            const reader = new FileReader();
            reader.onload = (e) => {
                previewImage.src = e.target.result;
                previewArea.style.display = 'block';
                generateBtn.disabled = false;
            };
            reader.readAsDataURL(file);
        }
        
        async function generateTestFromTopic() {
            const topic = document.getElementById('topic-input')?.value;
            const details = document.getElementById('topic-details')?.value;
            
            if (!topic) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹', 'error');
                return;
            }
            
            showLoading('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...');
            
            // Ù…Ø­Ø§ÙƒØ§Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
            await sleep(2000);
            
            const mockTest = {
                id: 'test_topic_' + Date.now(),
                title: `Ø§Ø®ØªØ¨Ø§Ø± ÙÙŠ: ${topic}`,
                questions: Array(20).fill(0).map((_, i) => ({
                    text: `Ø³Ø¤Ø§Ù„ ${i + 1} Ø­ÙˆÙ„ ${topic}: ${details ? details.substring(0, 50) : 'Ù…Ø§ Ù‡Ùˆ...'}`,
                    type: 'multiple_choice',
                    options: ['Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„', 'Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ', 'Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«', 'Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø¹'],
                    correctAnswer: 0,
                    difficulty: 'medium'
                }))
            };
            
            hideLoading();
            displayTest(mockTest);
            showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        }
        
        // ========== ØªÙ‡ÙŠØ¦Ø© Ø¥Ø¶Ø§ÙÙŠØ© ==========
        
        function showRegister() {
            // ØªÙ†ÙÙŠØ° ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
            Swal.fire({
                title: 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯',
                html: `
                    <input type="text" id="register-name" class="swal2-input" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
                    <input type="email" id="register-email" class="swal2-input" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
                    <input type="password" id="register-password" class="swal2-input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                    <select id="register-role" class="swal2-input">
                        <option value="student">Ø·Ø§Ù„Ø¨</option>
                        <option value="teacher">Ù…Ø¹Ù„Ù…</option>
                        <option value="researcher">Ø¨Ø§Ø­Ø«</option>
                    </select>
                `,
                confirmButtonText: 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨',
                showCancelButton: true,
                preConfirm: async () => {
                    const name = document.getElementById('register-name').value;
                    const email = document.getElementById('register-email').value;
                    const password = document.getElementById('register-password').value;
                    const role = document.getElementById('register-role').value;
                    
                    if (!name || !email || !password) {
                        Swal.showValidationMessage('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                        return false;
                    }
                    
                    const result = await userManager.register(email, password, {
                        name: name,
                        role: role,
                        preferences: {
                            theme: 'dark',
                            language: 'ar'
                        }
                    });
                    
                    if (!result.success) {
                        Swal.showValidationMessage(result.error);
                        return false;
                    }
                    
                    return result.user;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                }
            });
        }
        
        function checkUserSession() {
            const savedEmail = localStorage.getItem('ai_system_email');
            if (savedEmail) {
                document.getElementById('login-email').value = savedEmail;
            }
        }
        
        function isYesterday(date1, date2) {
            const d1 = new Date(date1);
            const d2 = new Date(date2);
            const diff = (d2 - d1) / (1000 * 60 * 60 * 24);
            return diff === 1;
        }
        
        // ========== ØªØµØ¯ÙŠØ± Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ ==========
        
        window.login = login;
        window.logout = logout;
        window.showRegister = showRegister;
        window.openModule = openModule;
        window.closeModule = closeModule;
        window.switchTestTab = switchTestTab;
        window.generateTest = generateTest;
        window.generateTestFromImage = generateTestFromImage;
        window.generateTestFromTopic = generateTestFromTopic;
        window.startTest = startTest;
        window.runAISimulation = runAISimulation;
        window.startAITraining = startAITraining;
        
        console.log('ğŸš€ Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ø®Ø§Ø±Ù‚ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…Ù„!');
        
        // Ù†Ø¸Ø§Ù… Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
        class BasicAI {
            async processText(text) {
                return {
                    analysis: { topics: ['Ø¹Ø§Ù…'] },
                    questions: Array(10).fill(0).map((_, i) => ({
                        text: `Ø³Ø¤Ø§Ù„ ${i + 1}: ${text.substring(0, 50)}...`,
                        type: 'multiple_choice',
                        options: ['Ø¥Ø¬Ø§Ø¨Ø© 1', 'Ø¥Ø¬Ø§Ø¨Ø© 2', 'Ø¥Ø¬Ø§Ø¨Ø© 3', 'Ø¥Ø¬Ø§Ø¨Ø© 4'],
                        correctAnswer: 0
                    }))
                };
            }
        }
        
        // Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªÙƒÙŠÙÙŠ
        class AdaptiveLearningEngine {
            async initialize() {
                console.log('ğŸ“š Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªÙƒÙŠÙÙŠ Ù…Ù‡ÙŠØ£');
            }
        }
        
        // Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¹Ù…ÙŠÙ‚
        class DeepLearningEngine {
            async initialize() {
                console.log('ğŸ§  Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¹Ù…ÙŠÙ‚ Ù…Ù‡ÙŠØ£');
            }
        }
        
        // Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù…Ø¹Ø²Ø²
        class ReinforcementLearningEngine {
            async initialize() {
                console.log('ğŸ¯ Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù…Ø¹Ø²Ø² Ù…Ù‡ÙŠØ£');
            }
        }
        
        // Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ·ÙˆØ± Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
        class EvolutionaryLearningEngine {
            async initialize() {
                console.log('ğŸ§¬ Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ·ÙˆØ± Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…Ù‡ÙŠØ£');
            }
        }
    </script>
</body>
</html>
